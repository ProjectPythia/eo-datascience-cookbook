{"version":3,"kind":"Notebook","sha256":"5b03c09855497f5d4692f0327a41bd582e334d957e7d22c5ff87d3f3d2b0d8a1","slug":"notebooks.courses.environmental-remote-sensing.unit-01.handout-drought-3","location":"/notebooks/courses/environmental-remote-sensing/unit_01/04_handout_drought.ipynb","dependencies":[],"frontmatter":{"title":"Leads and lags in Drought Dynamics","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Wolfgang Wagner","given":"Wolfgang","family":"Wagner"},"name":"Wolfgang Wagner","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Martin Schobben","given":"Martin","family":"Schobben"},"name":"Martin Schobben","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Nikolas Pikall","given":"Nikolas","family":"Pikall"},"name":"Nikolas Pikall","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Joseph Wagner","given":"Joseph","family":"Wagner"},"name":"Joseph Wagner","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Davide Festa","given":"Davide","family":"Festa"},"name":"Davide Festa","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Felix David Reuß","given":"Felix David","family":"Reuß"},"name":"Felix David Reuß","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Luka Jović","given":"Luka","family":"Jović"},"name":"Luka Jović","id":"contributors-myst-generated-uid-6"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":2}},"thumbnail":"/eo-datascience-cookbook/build/f20c6145ef56baa28c62ffb1caf68f93.webp","exports":[{"format":"ipynb","filename":"04_handout_drought.ipynb","url":"/eo-datascience-cookbook/build/04_handout_drought-20f01b15aca19260c9aa8f7db5f2463d.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Meteorological, Agricultural, and Hydrological Droughts","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wNgQTT4kzP"}],"key":"wFGVYFZ2Pm"}],"key":"QNUZoaTVC6"},{"type":"image","url":"/eo-datascience-cookbook/build/f20c6145ef56baa28c62ffb1caf68f93.webp","alt":"Source: Laura Crocetti et al., 2020","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"d1DYQqwpSL","urlSource":"https://media.springernature.com/full/springer-static/image/art%3A10.1007%2Fs10113-020-01710-w/MediaObjects/10113_2020_1710_Fig1_HTML.png?as=webp"},{"type":"heading","depth":2,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"zq2ufJJDBa"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"v5BTjbqbpa"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"In this notebook we will examine the propagation of precipitation deficits, soil water deficits, and finally their lagged effect on plants. This cascading effect of drought development, or so-called convergence of evidence, is important to study in areas where rain-fed agricultural practices are of importance, such as Mozambique.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"XAL6nJlpw6"}],"key":"rGauAIY1nV"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Classically drought have been categorized in four classes:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rS8rOoY4mW"}],"key":"GfcGoOruJF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Meteorological drought is described as the lack of precipitation and/or increased atmospheric demand (evapotranspiration)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HrUJznMk0x"}],"key":"sqZwE82KgD"}],"key":"CAlehDK1Ba"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Agricultural drought is also a physical phenomenon where soils become replete of moisture","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KSXPCX1WFL"}],"key":"uXWVVcE4ro"}],"key":"dY8XyjDfoH"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Hydrological drought follows when ongoing drought can then cause deficits in ground and surface reservoirs","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"YrM28svgeP"}],"key":"KDDgWh9CAF"}],"key":"PUOzmXbc2D"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Socioeconomic drought impacts society through crop loss, food insecurity, shortages of fresh-water resources","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"pGAhaFDJoF"}],"key":"BDfCp961xP"}],"key":"EcdeCP3gOF"}],"key":"siDCXzHPXF"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"The first three phenomena often follow in a cascading sequence, whereas all of them can have a direct impact on society.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"C2c2O4PvU4"}],"key":"rq1pKH4IxB"},{"type":"footnoteDefinition","identifier":"1","label":"1","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"L. Crocetti et al., Earth Observation for agricultural drought monitoring in the Pannonian Basin (southeastern Europe): current state and future directions, Reg Environ Change, vol. 20, no. 4, p. 123, Dec. 2020, doi: ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"IkAUvgx3rV"},{"type":"cite","url":"http://link.springer.com/10.1007/s10113-020-01710-w","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Crocetti ","key":"yoOkH7bmoU"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"nZut39TB6m"}],"key":"RF3jFv4CBa"},{"type":"text","value":" (2020)","key":"rAytDmUej6"}],"kind":"narrative","label":"Crocetti_2020","identifier":"http://link.springer.com/10.1007/s10113-020-01710-w","enumerator":"1","key":"ElkxG5IQAI"},{"type":"text","value":".","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"UhKP531wOe"}],"key":"xtPiG3CjHw"}],"key":"H9t8DObdZC"}],"key":"dXLVVKdP9l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import hvplot.pandas  # noqa\nimport pandas as pd\nimport statsmodels.formula.api as smf\nimport statsmodels.tsa.stattools as smt\nfrom envrs.corr_plots import plot_predicted_values, plot_step_corr\nfrom envrs.download_path import make_url","key":"FnAkYqqnxI"},{"type":"outputs","id":"G1zN7gV9Z6IueNmm2q7Dl","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script type=\"esms-options\">{\"shimMode\": true}</script><style>*[data-root-id],\n*[data-root-id] > * {\n  box-sizing: border-box;\n  font-family: var(--jp-ui-font-family);\n  font-size: var(--jp-ui-font-size1);\n  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));\n}\n\n/* Override VSCode background color */\n.cell-output-ipywidget-background:has(\n  > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]\n),\n.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {\n  background-color: transparent !important;\n}\n</style>","content_type":"text/html"}}},"key":"dGEaRwibLe"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/javascript":{"content":"(function(root) {\n  function now() {\n    return new Date();\n  }\n\n  const force = true;\n  const version = '3.8.1'.replace('rc', '-rc.').replace('.dev', '-dev.');\n  const reloading = false;\n  const Bokeh = root.Bokeh;\n  const BK_RE = /^https:\\/\\/cdn\\.bokeh\\.org\\/bokeh\\/(release|dev)\\/bokeh-/;\n  const PN_RE = /^https:\\/\\/cdn\\.holoviz\\.org\\/panel\\/[^/]+\\/dist\\/panel/i;\n\n  // Set a timeout for this load but only if we are not already initializing\n  if (typeof (root._bokeh_timeout) === \"undefined\" || (force || !root._bokeh_is_initializing)) {\n    root._bokeh_timeout = Date.now() + 5000;\n    root._bokeh_failed_load = false;\n  }\n\n  function run_callbacks() {\n    try {\n      root._bokeh_onload_callbacks.forEach(function(callback) {\n        if (callback != null)\n          callback();\n      });\n    } finally {\n      delete root._bokeh_onload_callbacks;\n    }\n    console.debug(\"Bokeh: all callbacks have finished\");\n  }\n\n  function load_libs(css_urls, js_urls, js_modules, js_exports, Bokeh, callback) {\n    if (css_urls == null) css_urls = [];\n    if (js_urls == null) js_urls = [];\n    if (js_modules == null) js_modules = [];\n    if (js_exports == null) js_exports = {};\n\n    root._bokeh_onload_callbacks.push(callback);\n\n    if (root._bokeh_is_loading > 0) {\n      // Don't load bokeh if it is still initializing\n      console.debug(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now());\n      return null;\n    } else if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {\n      // There is nothing to load\n      run_callbacks();\n      return null;\n    }\n\n    function on_load() {\n      root._bokeh_is_loading--;\n      if (root._bokeh_is_loading === 0) {\n        console.debug(\"Bokeh: all BokehJS libraries/stylesheets loaded\");\n        run_callbacks()\n      }\n    }\n    window._bokeh_on_load = on_load\n\n    function on_error(e) {\n      const src_el = e.srcElement\n      console.error(\"failed to load \" + (src_el.href || src_el.src));\n    }\n\n    const skip = [];\n    if (window.requirejs) {\n      window.requirejs.config({'packages': {}, 'paths': {}, 'shim': {}});\n      root._bokeh_is_loading = css_urls.length + 0;\n    } else {\n      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;\n    }\n\n    const existing_stylesheets = []\n    const links = document.getElementsByTagName('link')\n    for (let i = 0; i < links.length; i++) {\n      const link = links[i]\n      if (link.href != null) {\n        existing_stylesheets.push(link.href)\n      }\n    }\n    for (let i = 0; i < css_urls.length; i++) {\n      const url = css_urls[i];\n      const escaped = encodeURI(url)\n      if (existing_stylesheets.indexOf(escaped) !== -1) {\n        on_load()\n        continue;\n      }\n      const element = document.createElement(\"link\");\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.rel = \"stylesheet\";\n      element.type = \"text/css\";\n      element.href = url;\n      console.debug(\"Bokeh: injecting link tag for BokehJS stylesheet: \", url);\n      document.body.appendChild(element);\n    }    var existing_scripts = []\n    const scripts = document.getElementsByTagName('script')\n    for (let i = 0; i < scripts.length; i++) {\n      var script = scripts[i]\n      if (script.src != null) {\n        existing_scripts.push(script.src)\n      }\n    }\n    for (let i = 0; i < js_urls.length; i++) {\n      const url = js_urls[i];\n      const escaped = encodeURI(url)\n      const shouldSkip = skip.includes(escaped) || existing_scripts.includes(escaped)\n      const isBokehOrPanel = BK_RE.test(escaped) || PN_RE.test(escaped)\n      const missingOrBroken = Bokeh == null || Bokeh.Panel == null || (Bokeh.version != version && !Bokeh.versions?.has(version)) || Bokeh.versions?.get(version)?.Panel == null;\n      if (shouldSkip && !(isBokehOrPanel && missingOrBroken)) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      const element = document.createElement('script');\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.async = false;\n      element.src = url;\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.head.appendChild(element);\n    }\n    for (let i = 0; i < js_modules.length; i++) {\n      const url = js_modules[i];\n      const escaped = encodeURI(url)\n      if (skip.indexOf(escaped) !== -1 || existing_scripts.indexOf(escaped) !== -1) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      var element = document.createElement('script');\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.async = false;\n      element.src = url;\n      element.type = \"module\";\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.head.appendChild(element);\n    }\n    for (const name in js_exports) {\n      const url = js_exports[name];\n      const escaped = encodeURI(url)\n      if (skip.indexOf(escaped) >= 0 || root[name] != null) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      var element = document.createElement('script');\n      element.onerror = on_error;\n      element.async = false;\n      element.type = \"module\";\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      element.textContent = `\n      import ${name} from \"${url}\"\n      window.${name} = ${name}\n      window._bokeh_on_load()\n      `\n      document.head.appendChild(element);\n    }\n    if (!js_urls.length && !js_modules.length) {\n      on_load()\n    }\n  };\n\n  function inject_raw_css(css) {\n    const element = document.createElement(\"style\");\n    element.appendChild(document.createTextNode(css));\n    document.body.appendChild(element);\n  }\n\n  const js_urls = [\"https://cdn.holoviz.org/panel/1.8.5/dist/bundled/reactiveesm/es-module-shims@^1.10.0/dist/es-module-shims.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-3.8.1.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.8.1.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.8.1.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.8.1.min.js\", \"https://cdn.holoviz.org/panel/1.8.5/dist/panel.min.js\"];\n  const js_modules = [];\n  const js_exports = {};\n  const css_urls = [];\n  const inline_js = [    function(Bokeh) {\n      Bokeh.set_log_level(\"info\");\n    },\nfunction(Bokeh) {} // ensure no trailing comma for IE\n  ];\n\n  function run_inline_js() {\n    if ((root.Bokeh !== undefined) || (force === true)) {\n      for (let i = 0; i < inline_js.length; i++) {\n        try {\n          inline_js[i].call(root, root.Bokeh);\n        } catch(e) {\n          if (!reloading) {\n            throw e;\n          }\n        }\n      }\n    } else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(run_inline_js, 100);\n    } else if (!root._bokeh_failed_load) {\n      console.log(\"Bokeh: BokehJS failed to load within specified timeout.\");\n      root._bokeh_failed_load = true;\n    }\n    root._bokeh_is_initializing = false;\n  }\n\n  function load_or_wait() {\n    // Implement a backoff loop that tries to ensure we do not load multiple\n    // versions of Bokeh and its dependencies at the same time.\n    // In recent versions we use the root._bokeh_is_initializing flag\n    // to determine whether there is an ongoing attempt to initialize\n    // bokeh, however for backward compatibility we also try to ensure\n    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version\n    // before older versions are fully initialized.\n    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {\n      // If the timeout and bokeh was not successfully loaded we reset\n      // everything and try loading again\n      root._bokeh_timeout = Date.now() + 5000;\n      root._bokeh_is_initializing = false;\n      root._bokeh_onload_callbacks = undefined;\n      root._bokeh_is_loading = 0;\n      console.log(\"Bokeh: BokehJS was loaded multiple times but one version failed to initialize.\");\n      load_or_wait();\n    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === \"undefined\" && root._bokeh_onload_callbacks !== undefined)) {\n      setTimeout(load_or_wait, 100);\n    } else {\n      root._bokeh_is_initializing = true;\n      root._bokeh_onload_callbacks = [];\n      const bokeh_loaded = Bokeh != null && ((Bokeh.version === version && Bokeh.Panel) || (Bokeh.versions?.has(version) && Bokeh.versions.get(version)?.Panel));\n      if (!reloading && !bokeh_loaded) {\n        if (root.Bokeh) {\n          root.Bokeh = undefined;\n        }\n        console.debug(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now());\n      }\n      load_libs(css_urls, js_urls, js_modules, js_exports, Bokeh, function() {\n        console.debug(\"Bokeh: BokehJS plotting callback run at\", now());\n        run_inline_js();\n        if (Bokeh != undefined && !reloading) {\n          const NewBokeh = root.Bokeh;\n          if (Bokeh.versions === undefined) {\n            Bokeh.versions = new Map();\n          }\n          if (NewBokeh.version !== Bokeh.version) {\n            Bokeh[NewBokeh.version] = NewBokeh;\n            Bokeh.versions.set(NewBokeh.version, NewBokeh);\n          }\n          root.Bokeh = Bokeh;\n        }\n      });\n    }\n  }\n  // Give older versions of the autoload script a head-start to ensure\n  // they initialize before we start loading newer version.\n  setTimeout(load_or_wait, 100)\n}(window));","content_type":"application/javascript"},"application/vnd.holoviews_load.v0+json":{"content":"(function(root) {\n  function now() {\n    return new Date();\n  }\n\n  const force = true;\n  const version = '3.8.1'.replace('rc', '-rc.').replace('.dev', '-dev.');\n  const reloading = false;\n  const Bokeh = root.Bokeh;\n  const BK_RE = /^https:\\/\\/cdn\\.bokeh\\.org\\/bokeh\\/(release|dev)\\/bokeh-/;\n  const PN_RE = /^https:\\/\\/cdn\\.holoviz\\.org\\/panel\\/[^/]+\\/dist\\/panel/i;\n\n  // Set a timeout for this load but only if we are not already initializing\n  if (typeof (root._bokeh_timeout) === \"undefined\" || (force || !root._bokeh_is_initializing)) {\n    root._bokeh_timeout = Date.now() + 5000;\n    root._bokeh_failed_load = false;\n  }\n\n  function run_callbacks() {\n    try {\n      root._bokeh_onload_callbacks.forEach(function(callback) {\n        if (callback != null)\n          callback();\n      });\n    } finally {\n      delete root._bokeh_onload_callbacks;\n    }\n    console.debug(\"Bokeh: all callbacks have finished\");\n  }\n\n  function load_libs(css_urls, js_urls, js_modules, js_exports, Bokeh, callback) {\n    if (css_urls == null) css_urls = [];\n    if (js_urls == null) js_urls = [];\n    if (js_modules == null) js_modules = [];\n    if (js_exports == null) js_exports = {};\n\n    root._bokeh_onload_callbacks.push(callback);\n\n    if (root._bokeh_is_loading > 0) {\n      // Don't load bokeh if it is still initializing\n      console.debug(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now());\n      return null;\n    } else if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {\n      // There is nothing to load\n      run_callbacks();\n      return null;\n    }\n\n    function on_load() {\n      root._bokeh_is_loading--;\n      if (root._bokeh_is_loading === 0) {\n        console.debug(\"Bokeh: all BokehJS libraries/stylesheets loaded\");\n        run_callbacks()\n      }\n    }\n    window._bokeh_on_load = on_load\n\n    function on_error(e) {\n      const src_el = e.srcElement\n      console.error(\"failed to load \" + (src_el.href || src_el.src));\n    }\n\n    const skip = [];\n    if (window.requirejs) {\n      window.requirejs.config({'packages': {}, 'paths': {}, 'shim': {}});\n      root._bokeh_is_loading = css_urls.length + 0;\n    } else {\n      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;\n    }\n\n    const existing_stylesheets = []\n    const links = document.getElementsByTagName('link')\n    for (let i = 0; i < links.length; i++) {\n      const link = links[i]\n      if (link.href != null) {\n        existing_stylesheets.push(link.href)\n      }\n    }\n    for (let i = 0; i < css_urls.length; i++) {\n      const url = css_urls[i];\n      const escaped = encodeURI(url)\n      if (existing_stylesheets.indexOf(escaped) !== -1) {\n        on_load()\n        continue;\n      }\n      const element = document.createElement(\"link\");\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.rel = \"stylesheet\";\n      element.type = \"text/css\";\n      element.href = url;\n      console.debug(\"Bokeh: injecting link tag for BokehJS stylesheet: \", url);\n      document.body.appendChild(element);\n    }    var existing_scripts = []\n    const scripts = document.getElementsByTagName('script')\n    for (let i = 0; i < scripts.length; i++) {\n      var script = scripts[i]\n      if (script.src != null) {\n        existing_scripts.push(script.src)\n      }\n    }\n    for (let i = 0; i < js_urls.length; i++) {\n      const url = js_urls[i];\n      const escaped = encodeURI(url)\n      const shouldSkip = skip.includes(escaped) || existing_scripts.includes(escaped)\n      const isBokehOrPanel = BK_RE.test(escaped) || PN_RE.test(escaped)\n      const missingOrBroken = Bokeh == null || Bokeh.Panel == null || (Bokeh.version != version && !Bokeh.versions?.has(version)) || Bokeh.versions?.get(version)?.Panel == null;\n      if (shouldSkip && !(isBokehOrPanel && missingOrBroken)) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      const element = document.createElement('script');\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.async = false;\n      element.src = url;\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.head.appendChild(element);\n    }\n    for (let i = 0; i < js_modules.length; i++) {\n      const url = js_modules[i];\n      const escaped = encodeURI(url)\n      if (skip.indexOf(escaped) !== -1 || existing_scripts.indexOf(escaped) !== -1) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      var element = document.createElement('script');\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.async = false;\n      element.src = url;\n      element.type = \"module\";\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.head.appendChild(element);\n    }\n    for (const name in js_exports) {\n      const url = js_exports[name];\n      const escaped = encodeURI(url)\n      if (skip.indexOf(escaped) >= 0 || root[name] != null) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      var element = document.createElement('script');\n      element.onerror = on_error;\n      element.async = false;\n      element.type = \"module\";\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      element.textContent = `\n      import ${name} from \"${url}\"\n      window.${name} = ${name}\n      window._bokeh_on_load()\n      `\n      document.head.appendChild(element);\n    }\n    if (!js_urls.length && !js_modules.length) {\n      on_load()\n    }\n  };\n\n  function inject_raw_css(css) {\n    const element = document.createElement(\"style\");\n    element.appendChild(document.createTextNode(css));\n    document.body.appendChild(element);\n  }\n\n  const js_urls = [\"https://cdn.holoviz.org/panel/1.8.5/dist/bundled/reactiveesm/es-module-shims@^1.10.0/dist/es-module-shims.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-3.8.1.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.8.1.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.8.1.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.8.1.min.js\", \"https://cdn.holoviz.org/panel/1.8.5/dist/panel.min.js\"];\n  const js_modules = [];\n  const js_exports = {};\n  const css_urls = [];\n  const inline_js = [    function(Bokeh) {\n      Bokeh.set_log_level(\"info\");\n    },\nfunction(Bokeh) {} // ensure no trailing comma for IE\n  ];\n\n  function run_inline_js() {\n    if ((root.Bokeh !== undefined) || (force === true)) {\n      for (let i = 0; i < inline_js.length; i++) {\n        try {\n          inline_js[i].call(root, root.Bokeh);\n        } catch(e) {\n          if (!reloading) {\n            throw e;\n          }\n        }\n      }\n    } else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(run_inline_js, 100);\n    } else if (!root._bokeh_failed_load) {\n      console.log(\"Bokeh: BokehJS failed to load within specified timeout.\");\n      root._bokeh_failed_load = true;\n    }\n    root._bokeh_is_initializing = false;\n  }\n\n  function load_or_wait() {\n    // Implement a backoff loop that tries to ensure we do not load multiple\n    // versions of Bokeh and its dependencies at the same time.\n    // In recent versions we use the root._bokeh_is_initializing flag\n    // to determine whether there is an ongoing attempt to initialize\n    // bokeh, however for backward compatibility we also try to ensure\n    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version\n    // before older versions are fully initialized.\n    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {\n      // If the timeout and bokeh was not successfully loaded we reset\n      // everything and try loading again\n      root._bokeh_timeout = Date.now() + 5000;\n      root._bokeh_is_initializing = false;\n      root._bokeh_onload_callbacks = undefined;\n      root._bokeh_is_loading = 0;\n      console.log(\"Bokeh: BokehJS was loaded multiple times but one version failed to initialize.\");\n      load_or_wait();\n    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === \"undefined\" && root._bokeh_onload_callbacks !== undefined)) {\n      setTimeout(load_or_wait, 100);\n    } else {\n      root._bokeh_is_initializing = true;\n      root._bokeh_onload_callbacks = [];\n      const bokeh_loaded = Bokeh != null && ((Bokeh.version === version && Bokeh.Panel) || (Bokeh.versions?.has(version) && Bokeh.versions.get(version)?.Panel));\n      if (!reloading && !bokeh_loaded) {\n        if (root.Bokeh) {\n          root.Bokeh = undefined;\n        }\n        console.debug(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now());\n      }\n      load_libs(css_urls, js_urls, js_modules, js_exports, Bokeh, function() {\n        console.debug(\"Bokeh: BokehJS plotting callback run at\", now());\n        run_inline_js();\n        if (Bokeh != undefined && !reloading) {\n          const NewBokeh = root.Bokeh;\n          if (Bokeh.versions === undefined) {\n            Bokeh.versions = new Map();\n          }\n          if (NewBokeh.version !== Bokeh.version) {\n            Bokeh[NewBokeh.version] = NewBokeh;\n            Bokeh.versions.set(NewBokeh.version, NewBokeh);\n          }\n          root.Bokeh = Bokeh;\n        }\n      });\n    }\n  }\n  // Give older versions of the autoload script a head-start to ensure\n  // they initialize before we start loading newer version.\n  setTimeout(load_or_wait, 100)\n}(window));","content_type":"application/vnd.holoviews_load.v0+json"}}},"key":"w51t3es9QU"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.holoviews_load.v0+json":{"content":"\nif ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {\n  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}\n}\n\n\n    function JupyterCommManager() {\n    }\n\n    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {\n      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {\n        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;\n        comm_manager.register_target(comm_id, function(comm) {\n          comm.on_msg(msg_handler);\n        });\n      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {\n        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {\n          comm.onMsg = msg_handler;\n        });\n      } else if (typeof google != 'undefined' && google.colab.kernel != null) {\n        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {\n          var messages = comm.messages[Symbol.asyncIterator]();\n          function processIteratorResult(result) {\n            var message = result.value;\n            console.log(message)\n            var content = {data: message.data, comm_id};\n            var buffers = []\n            for (var buffer of message.buffers || []) {\n              buffers.push(new DataView(buffer))\n            }\n            var metadata = message.metadata || {};\n            var msg = {content, buffers, metadata}\n            msg_handler(msg);\n            return messages.next().then(processIteratorResult);\n          }\n          return messages.next().then(processIteratorResult);\n        })\n      }\n    }\n\n    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {\n      if (comm_id in window.PyViz.comms) {\n        return window.PyViz.comms[comm_id];\n      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {\n        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;\n        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);\n        if (msg_handler) {\n          comm.on_msg(msg_handler);\n        }\n      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {\n        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);\n        comm.open();\n        if (msg_handler) {\n          comm.onMsg = msg_handler;\n        }\n      } else if (typeof google != 'undefined' && google.colab.kernel != null) {\n        var comm_promise = google.colab.kernel.comms.open(comm_id)\n        comm_promise.then((comm) => {\n          window.PyViz.comms[comm_id] = comm;\n          if (msg_handler) {\n            var messages = comm.messages[Symbol.asyncIterator]();\n            function processIteratorResult(result) {\n              var message = result.value;\n              var content = {data: message.data};\n              var metadata = message.metadata || {comm_id};\n              var msg = {content, metadata}\n              msg_handler(msg);\n              return messages.next().then(processIteratorResult);\n            }\n            return messages.next().then(processIteratorResult);\n          }\n        })\n        var sendClosure = (data, metadata, buffers, disposeOnDone) => {\n          return comm_promise.then((comm) => {\n            comm.send(data, metadata, buffers, disposeOnDone);\n          });\n        };\n        var comm = {\n          send: sendClosure\n        };\n      }\n      window.PyViz.comms[comm_id] = comm;\n      return comm;\n    }\n    window.PyViz.comm_manager = new JupyterCommManager();\n    \n\n\nvar JS_MIME_TYPE = 'application/javascript';\nvar HTML_MIME_TYPE = 'text/html';\nvar EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';\nvar CLASS_NAME = 'output';\n\n/**\n * Render data to the DOM node\n */\nfunction render(props, node) {\n  var div = document.createElement(\"div\");\n  var script = document.createElement(\"script\");\n  node.appendChild(div);\n  node.appendChild(script);\n}\n\n/**\n * Handle when a new output is added\n */\nfunction handle_add_output(event, handle) {\n  var output_area = handle.output_area;\n  var output = handle.output;\n  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {\n    return\n  }\n  var id = output.metadata[EXEC_MIME_TYPE][\"id\"];\n  var toinsert = output_area.element.find(\".\" + CLASS_NAME.split(' ')[0]);\n  if (id !== undefined) {\n    var nchildren = toinsert.length;\n    var html_node = toinsert[nchildren-1].children[0];\n    html_node.innerHTML = output.data[HTML_MIME_TYPE];\n    var scripts = [];\n    var nodelist = html_node.querySelectorAll(\"script\");\n    for (var i in nodelist) {\n      if (nodelist.hasOwnProperty(i)) {\n        scripts.push(nodelist[i])\n      }\n    }\n\n    scripts.forEach( function (oldScript) {\n      var newScript = document.createElement(\"script\");\n      var attrs = [];\n      var nodemap = oldScript.attributes;\n      for (var j in nodemap) {\n        if (nodemap.hasOwnProperty(j)) {\n          attrs.push(nodemap[j])\n        }\n      }\n      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });\n      newScript.appendChild(document.createTextNode(oldScript.innerHTML));\n      oldScript.parentNode.replaceChild(newScript, oldScript);\n    });\n    if (JS_MIME_TYPE in output.data) {\n      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];\n    }\n    output_area._hv_plot_id = id;\n    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {\n      window.PyViz.plot_index[id] = Bokeh.index[id];\n    } else {\n      window.PyViz.plot_index[id] = null;\n    }\n  } else if (output.metadata[EXEC_MIME_TYPE][\"server_id\"] !== undefined) {\n    var bk_div = document.createElement(\"div\");\n    bk_div.innerHTML = output.data[HTML_MIME_TYPE];\n    var script_attrs = bk_div.children[0].attributes;\n    for (var i = 0; i < script_attrs.length; i++) {\n      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);\n    }\n    // store reference to server id on output_area\n    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE][\"server_id\"];\n  }\n}\n\n/**\n * Handle when an output is cleared or removed\n */\nfunction handle_clear_output(event, handle) {\n  var id = handle.cell.output_area._hv_plot_id;\n  var server_id = handle.cell.output_area._bokeh_server_id;\n  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }\n  var comm = window.PyViz.comm_manager.get_client_comm(\"hv-extension-comm\", \"hv-extension-comm\", function () {});\n  if (server_id !== null) {\n    comm.send({event_type: 'server_delete', 'id': server_id});\n    return;\n  } else if (comm !== null) {\n    comm.send({event_type: 'delete', 'id': id});\n  }\n  delete PyViz.plot_index[id];\n  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {\n    var doc = window.Bokeh.index[id].model.document\n    doc.clear();\n    const i = window.Bokeh.documents.indexOf(doc);\n    if (i > -1) {\n      window.Bokeh.documents.splice(i, 1);\n    }\n  }\n}\n\n/**\n * Handle kernel restart event\n */\nfunction handle_kernel_cleanup(event, handle) {\n  delete PyViz.comms[\"hv-extension-comm\"];\n  window.PyViz.plot_index = {}\n}\n\n/**\n * Handle update_display_data messages\n */\nfunction handle_update_output(event, handle) {\n  handle_clear_output(event, {cell: {output_area: handle.output_area}})\n  handle_add_output(event, handle)\n}\n\nfunction register_renderer(events, OutputArea) {\n  function append_mime(data, metadata, element) {\n    // create a DOM node to render to\n    var toinsert = this.create_output_subarea(\n    metadata,\n    CLASS_NAME,\n    EXEC_MIME_TYPE\n    );\n    this.keyboard_manager.register_events(toinsert);\n    // Render to node\n    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};\n    render(props, toinsert[0]);\n    element.append(toinsert);\n    return toinsert\n  }\n\n  events.on('output_added.OutputArea', handle_add_output);\n  events.on('output_updated.OutputArea', handle_update_output);\n  events.on('clear_output.CodeCell', handle_clear_output);\n  events.on('delete.Cell', handle_clear_output);\n  events.on('kernel_ready.Kernel', handle_kernel_cleanup);\n\n  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {\n    safe: true,\n    index: 0\n  });\n}\n\nif (window.Jupyter !== undefined) {\n  try {\n    var events = require('base/js/events');\n    var OutputArea = require('notebook/js/outputarea').OutputArea;\n    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {\n      register_renderer(events, OutputArea);\n    }\n  } catch(err) {\n  }\n}\n","content_type":"application/vnd.holoviews_load.v0+json"},"application/javascript":{"content":"\nif ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {\n  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}\n}\n\n\n    function JupyterCommManager() {\n    }\n\n    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {\n      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {\n        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;\n        comm_manager.register_target(comm_id, function(comm) {\n          comm.on_msg(msg_handler);\n        });\n      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {\n        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {\n          comm.onMsg = msg_handler;\n        });\n      } else if (typeof google != 'undefined' && google.colab.kernel != null) {\n        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {\n          var messages = comm.messages[Symbol.asyncIterator]();\n          function processIteratorResult(result) {\n            var message = result.value;\n            console.log(message)\n            var content = {data: message.data, comm_id};\n            var buffers = []\n            for (var buffer of message.buffers || []) {\n              buffers.push(new DataView(buffer))\n            }\n            var metadata = message.metadata || {};\n            var msg = {content, buffers, metadata}\n            msg_handler(msg);\n            return messages.next().then(processIteratorResult);\n          }\n          return messages.next().then(processIteratorResult);\n        })\n      }\n    }\n\n    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {\n      if (comm_id in window.PyViz.comms) {\n        return window.PyViz.comms[comm_id];\n      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {\n        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;\n        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);\n        if (msg_handler) {\n          comm.on_msg(msg_handler);\n        }\n      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {\n        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);\n        comm.open();\n        if (msg_handler) {\n          comm.onMsg = msg_handler;\n        }\n      } else if (typeof google != 'undefined' && google.colab.kernel != null) {\n        var comm_promise = google.colab.kernel.comms.open(comm_id)\n        comm_promise.then((comm) => {\n          window.PyViz.comms[comm_id] = comm;\n          if (msg_handler) {\n            var messages = comm.messages[Symbol.asyncIterator]();\n            function processIteratorResult(result) {\n              var message = result.value;\n              var content = {data: message.data};\n              var metadata = message.metadata || {comm_id};\n              var msg = {content, metadata}\n              msg_handler(msg);\n              return messages.next().then(processIteratorResult);\n            }\n            return messages.next().then(processIteratorResult);\n          }\n        })\n        var sendClosure = (data, metadata, buffers, disposeOnDone) => {\n          return comm_promise.then((comm) => {\n            comm.send(data, metadata, buffers, disposeOnDone);\n          });\n        };\n        var comm = {\n          send: sendClosure\n        };\n      }\n      window.PyViz.comms[comm_id] = comm;\n      return comm;\n    }\n    window.PyViz.comm_manager = new JupyterCommManager();\n    \n\n\nvar JS_MIME_TYPE = 'application/javascript';\nvar HTML_MIME_TYPE = 'text/html';\nvar EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';\nvar CLASS_NAME = 'output';\n\n/**\n * Render data to the DOM node\n */\nfunction render(props, node) {\n  var div = document.createElement(\"div\");\n  var script = document.createElement(\"script\");\n  node.appendChild(div);\n  node.appendChild(script);\n}\n\n/**\n * Handle when a new output is added\n */\nfunction handle_add_output(event, handle) {\n  var output_area = handle.output_area;\n  var output = handle.output;\n  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {\n    return\n  }\n  var id = output.metadata[EXEC_MIME_TYPE][\"id\"];\n  var toinsert = output_area.element.find(\".\" + CLASS_NAME.split(' ')[0]);\n  if (id !== undefined) {\n    var nchildren = toinsert.length;\n    var html_node = toinsert[nchildren-1].children[0];\n    html_node.innerHTML = output.data[HTML_MIME_TYPE];\n    var scripts = [];\n    var nodelist = html_node.querySelectorAll(\"script\");\n    for (var i in nodelist) {\n      if (nodelist.hasOwnProperty(i)) {\n        scripts.push(nodelist[i])\n      }\n    }\n\n    scripts.forEach( function (oldScript) {\n      var newScript = document.createElement(\"script\");\n      var attrs = [];\n      var nodemap = oldScript.attributes;\n      for (var j in nodemap) {\n        if (nodemap.hasOwnProperty(j)) {\n          attrs.push(nodemap[j])\n        }\n      }\n      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });\n      newScript.appendChild(document.createTextNode(oldScript.innerHTML));\n      oldScript.parentNode.replaceChild(newScript, oldScript);\n    });\n    if (JS_MIME_TYPE in output.data) {\n      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];\n    }\n    output_area._hv_plot_id = id;\n    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {\n      window.PyViz.plot_index[id] = Bokeh.index[id];\n    } else {\n      window.PyViz.plot_index[id] = null;\n    }\n  } else if (output.metadata[EXEC_MIME_TYPE][\"server_id\"] !== undefined) {\n    var bk_div = document.createElement(\"div\");\n    bk_div.innerHTML = output.data[HTML_MIME_TYPE];\n    var script_attrs = bk_div.children[0].attributes;\n    for (var i = 0; i < script_attrs.length; i++) {\n      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);\n    }\n    // store reference to server id on output_area\n    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE][\"server_id\"];\n  }\n}\n\n/**\n * Handle when an output is cleared or removed\n */\nfunction handle_clear_output(event, handle) {\n  var id = handle.cell.output_area._hv_plot_id;\n  var server_id = handle.cell.output_area._bokeh_server_id;\n  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }\n  var comm = window.PyViz.comm_manager.get_client_comm(\"hv-extension-comm\", \"hv-extension-comm\", function () {});\n  if (server_id !== null) {\n    comm.send({event_type: 'server_delete', 'id': server_id});\n    return;\n  } else if (comm !== null) {\n    comm.send({event_type: 'delete', 'id': id});\n  }\n  delete PyViz.plot_index[id];\n  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {\n    var doc = window.Bokeh.index[id].model.document\n    doc.clear();\n    const i = window.Bokeh.documents.indexOf(doc);\n    if (i > -1) {\n      window.Bokeh.documents.splice(i, 1);\n    }\n  }\n}\n\n/**\n * Handle kernel restart event\n */\nfunction handle_kernel_cleanup(event, handle) {\n  delete PyViz.comms[\"hv-extension-comm\"];\n  window.PyViz.plot_index = {}\n}\n\n/**\n * Handle update_display_data messages\n */\nfunction handle_update_output(event, handle) {\n  handle_clear_output(event, {cell: {output_area: handle.output_area}})\n  handle_add_output(event, handle)\n}\n\nfunction register_renderer(events, OutputArea) {\n  function append_mime(data, metadata, element) {\n    // create a DOM node to render to\n    var toinsert = this.create_output_subarea(\n    metadata,\n    CLASS_NAME,\n    EXEC_MIME_TYPE\n    );\n    this.keyboard_manager.register_events(toinsert);\n    // Render to node\n    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};\n    render(props, toinsert[0]);\n    element.append(toinsert);\n    return toinsert\n  }\n\n  events.on('output_added.OutputArea', handle_add_output);\n  events.on('output_updated.OutputArea', handle_update_output);\n  events.on('clear_output.CodeCell', handle_clear_output);\n  events.on('delete.Cell', handle_clear_output);\n  events.on('kernel_ready.Kernel', handle_kernel_cleanup);\n\n  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {\n    safe: true,\n    index: 0\n  });\n}\n\nif (window.Jupyter !== undefined) {\n  try {\n    var events = require('base/js/events');\n    var OutputArea = require('notebook/js/outputarea').OutputArea;\n    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {\n      register_renderer(events, OutputArea);\n    }\n  } catch(err) {\n  }\n}\n","content_type":"application/javascript"}}},"key":"KY8C3lPgzo"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{"application/vnd.holoviews_exec.v0+json":{"id":"ea6e4699-8be4-4aef-bba6-38d3c2aecc55"}},"data":{"text/html":{"content":"<div id='ea6e4699-8be4-4aef-bba6-38d3c2aecc55'>\n  <div id=\"fc3693f1-7e5c-480f-89cd-b4c72547f080\" data-root-id=\"ea6e4699-8be4-4aef-bba6-38d3c2aecc55\" style=\"display: contents;\"></div>\n</div>\n<script type=\"application/javascript\">(function(root) {\n  var docs_json = {\"95372fc2-a25b-4e45-8edc-0232c4c37688\":{\"version\":\"3.8.1\",\"title\":\"Bokeh Application\",\"config\":{\"type\":\"object\",\"name\":\"DocumentConfig\",\"id\":\"a4bfdfbc-fa6a-48b2-9c97-7e9fca4798b0\",\"attributes\":{\"notifications\":{\"type\":\"object\",\"name\":\"Notifications\",\"id\":\"277ed494-c406-46e7-9055-38f80023483e\"}}},\"roots\":[{\"type\":\"object\",\"name\":\"panel.models.browser.BrowserInfo\",\"id\":\"ea6e4699-8be4-4aef-bba6-38d3c2aecc55\"},{\"type\":\"object\",\"name\":\"panel.models.comm_manager.CommManager\",\"id\":\"b4a38832-77b3-4d4b-a97e-b1311c11f383\",\"attributes\":{\"plot_id\":\"ea6e4699-8be4-4aef-bba6-38d3c2aecc55\",\"comm_id\":\"a2abcc42c2af4d2082f58f572c4f5eba\",\"client_comm_id\":\"40216366dd3a4f11abe45a362b926d93\"}}],\"defs\":[{\"type\":\"model\",\"name\":\"ReactiveHTML1\"},{\"type\":\"model\",\"name\":\"FlexBox1\",\"properties\":[{\"name\":\"align_content\",\"kind\":\"Any\",\"default\":\"flex-start\"},{\"name\":\"align_items\",\"kind\":\"Any\",\"default\":\"flex-start\"},{\"name\":\"flex_direction\",\"kind\":\"Any\",\"default\":\"row\"},{\"name\":\"flex_wrap\",\"kind\":\"Any\",\"default\":\"wrap\"},{\"name\":\"gap\",\"kind\":\"Any\",\"default\":\"\"},{\"name\":\"justify_content\",\"kind\":\"Any\",\"default\":\"flex-start\"}]},{\"type\":\"model\",\"name\":\"FloatPanel1\",\"properties\":[{\"name\":\"config\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}},{\"name\":\"contained\",\"kind\":\"Any\",\"default\":true},{\"name\":\"position\",\"kind\":\"Any\",\"default\":\"right-top\"},{\"name\":\"offsetx\",\"kind\":\"Any\",\"default\":null},{\"name\":\"offsety\",\"kind\":\"Any\",\"default\":null},{\"name\":\"theme\",\"kind\":\"Any\",\"default\":\"primary\"},{\"name\":\"status\",\"kind\":\"Any\",\"default\":\"normalized\"}]},{\"type\":\"model\",\"name\":\"GridStack1\",\"properties\":[{\"name\":\"ncols\",\"kind\":\"Any\",\"default\":null},{\"name\":\"nrows\",\"kind\":\"Any\",\"default\":null},{\"name\":\"allow_resize\",\"kind\":\"Any\",\"default\":true},{\"name\":\"allow_drag\",\"kind\":\"Any\",\"default\":true},{\"name\":\"state\",\"kind\":\"Any\",\"default\":[]}]},{\"type\":\"model\",\"name\":\"drag1\",\"properties\":[{\"name\":\"slider_width\",\"kind\":\"Any\",\"default\":5},{\"name\":\"slider_color\",\"kind\":\"Any\",\"default\":\"black\"},{\"name\":\"start\",\"kind\":\"Any\",\"default\":0},{\"name\":\"end\",\"kind\":\"Any\",\"default\":100},{\"name\":\"value\",\"kind\":\"Any\",\"default\":50}]},{\"type\":\"model\",\"name\":\"click1\",\"properties\":[{\"name\":\"terminal_output\",\"kind\":\"Any\",\"default\":\"\"},{\"name\":\"debug_name\",\"kind\":\"Any\",\"default\":\"\"},{\"name\":\"clears\",\"kind\":\"Any\",\"default\":0}]},{\"type\":\"model\",\"name\":\"ReactiveESM1\",\"properties\":[{\"name\":\"esm_constants\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}}]},{\"type\":\"model\",\"name\":\"JSComponent1\",\"properties\":[{\"name\":\"esm_constants\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}}]},{\"type\":\"model\",\"name\":\"ReactComponent1\",\"properties\":[{\"name\":\"use_shadow_dom\",\"kind\":\"Any\",\"default\":true},{\"name\":\"esm_constants\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}}]},{\"type\":\"model\",\"name\":\"AnyWidgetComponent1\",\"properties\":[{\"name\":\"use_shadow_dom\",\"kind\":\"Any\",\"default\":true},{\"name\":\"esm_constants\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}}]},{\"type\":\"model\",\"name\":\"FastWrapper1\",\"properties\":[{\"name\":\"object\",\"kind\":\"Any\",\"default\":null},{\"name\":\"style\",\"kind\":\"Any\",\"default\":null}]},{\"type\":\"model\",\"name\":\"NotificationArea1\",\"properties\":[{\"name\":\"js_events\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}},{\"name\":\"max_notifications\",\"kind\":\"Any\",\"default\":5},{\"name\":\"notifications\",\"kind\":\"Any\",\"default\":[]},{\"name\":\"position\",\"kind\":\"Any\",\"default\":\"bottom-right\"},{\"name\":\"_clear\",\"kind\":\"Any\",\"default\":0},{\"name\":\"types\",\"kind\":\"Any\",\"default\":[{\"type\":\"map\",\"entries\":[[\"type\",\"warning\"],[\"background\",\"#ffc107\"],[\"icon\",{\"type\":\"map\",\"entries\":[[\"className\",\"fas fa-exclamation-triangle\"],[\"tagName\",\"i\"],[\"color\",\"white\"]]}]]},{\"type\":\"map\",\"entries\":[[\"type\",\"info\"],[\"background\",\"#007bff\"],[\"icon\",{\"type\":\"map\",\"entries\":[[\"className\",\"fas fa-info-circle\"],[\"tagName\",\"i\"],[\"color\",\"white\"]]}]]}]}]},{\"type\":\"model\",\"name\":\"Notification\",\"properties\":[{\"name\":\"background\",\"kind\":\"Any\",\"default\":null},{\"name\":\"duration\",\"kind\":\"Any\",\"default\":3000},{\"name\":\"icon\",\"kind\":\"Any\",\"default\":null},{\"name\":\"message\",\"kind\":\"Any\",\"default\":\"\"},{\"name\":\"notification_type\",\"kind\":\"Any\",\"default\":null},{\"name\":\"_rendered\",\"kind\":\"Any\",\"default\":false},{\"name\":\"_destroyed\",\"kind\":\"Any\",\"default\":false}]},{\"type\":\"model\",\"name\":\"TemplateActions1\",\"properties\":[{\"name\":\"open_modal\",\"kind\":\"Any\",\"default\":0},{\"name\":\"close_modal\",\"kind\":\"Any\",\"default\":0}]},{\"type\":\"model\",\"name\":\"BootstrapTemplateActions1\",\"properties\":[{\"name\":\"open_modal\",\"kind\":\"Any\",\"default\":0},{\"name\":\"close_modal\",\"kind\":\"Any\",\"default\":0}]},{\"type\":\"model\",\"name\":\"TemplateEditor1\",\"properties\":[{\"name\":\"layout\",\"kind\":\"Any\",\"default\":[]}]},{\"type\":\"model\",\"name\":\"MaterialTemplateActions1\",\"properties\":[{\"name\":\"open_modal\",\"kind\":\"Any\",\"default\":0},{\"name\":\"close_modal\",\"kind\":\"Any\",\"default\":0}]},{\"type\":\"model\",\"name\":\"request_value1\",\"properties\":[{\"name\":\"fill\",\"kind\":\"Any\",\"default\":\"none\"},{\"name\":\"_synced\",\"kind\":\"Any\",\"default\":null},{\"name\":\"_request_sync\",\"kind\":\"Any\",\"default\":0}]},{\"type\":\"model\",\"name\":\"holoviews.plotting.bokeh.raster.HoverModel\",\"properties\":[{\"name\":\"xy\",\"kind\":\"Any\",\"default\":null},{\"name\":\"data\",\"kind\":\"Any\",\"default\":null}]}]}};\n  var render_items = [{\"docid\":\"95372fc2-a25b-4e45-8edc-0232c4c37688\",\"roots\":{\"ea6e4699-8be4-4aef-bba6-38d3c2aecc55\":\"fc3693f1-7e5c-480f-89cd-b4c72547f080\"},\"root_ids\":[\"ea6e4699-8be4-4aef-bba6-38d3c2aecc55\"]}];\n  var docs = Object.values(docs_json)\n  if (!docs) {\n    return\n  }\n  const version = docs[0].version.replace('rc', '-rc.').replace('.dev', '-dev.')\n  async function embed_document(root) {\n    var Bokeh = get_bokeh(root)\n    await Bokeh.embed.embed_items_notebook(docs_json, render_items);\n    for (const render_item of render_items) {\n      for (const root_id of render_item.root_ids) {\n\tconst id_el = document.getElementById(root_id)\n\tif (id_el.children.length && id_el.children[0].hasAttribute('data-root-id')) {\n\t  const root_el = id_el.children[0]\n\t  root_el.id = root_el.id + '-rendered'\n\t  for (const child of root_el.children) {\n            // Ensure JupyterLab does not capture keyboard shortcuts\n            // see: https://jupyterlab.readthedocs.io/en/4.1.x/extension/notebook.html#keyboard-interaction-model\n\t    child.setAttribute('data-lm-suppress-shortcuts', 'true')\n\t  }\n\t}\n      }\n    }\n  }\n  function get_bokeh(root) {\n    if (root.Bokeh === undefined) {\n      return null\n    } else if (root.Bokeh.version !== version) {\n      if (root.Bokeh.versions === undefined || !root.Bokeh.versions.has(version)) {\n\treturn null\n      }\n      return root.Bokeh.versions.get(version);\n    } else if (root.Bokeh.version === version) {\n      return root.Bokeh\n    }\n    return null\n  }\n  function is_loaded(root) {\n    var Bokeh = get_bokeh(root)\n    return (Bokeh != null && Bokeh.Panel !== undefined)\n  }\n  if (is_loaded(root)) {\n    embed_document(root);\n  } else {\n    var attempts = 0;\n    var timer = setInterval(function(root) {\n      if (is_loaded(root)) {\n        clearInterval(timer);\n        embed_document(root);\n      } else if (document.readyState == \"complete\") {\n        attempts++;\n        if (attempts > 200) {\n          clearInterval(timer);\n\t  var Bokeh = get_bokeh(root)\n\t  if (Bokeh == null || Bokeh.Panel == null) {\n            console.warn(\"Panel: ERROR: Unable to run Panel code because Bokeh or Panel library is missing\");\n\t  } else {\n\t    console.warn(\"Panel: WARNING: Attempting to render but not all required libraries could be resolved.\")\n\t    embed_document(root)\n\t  }\n        }\n      }\n    }, 25, root)\n  }\n})(window);</script>","content_type":"text/html"},"application/vnd.holoviews_exec.v0+json":{"content":"","content_type":"application/vnd.holoviews_exec.v0+json"}}},"key":"PnjVoTyFbz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Resolve path ffmpeg: /home/runner/micromamba/envs/eo-datascience-cookbook/bin/ffmpeg\n"},"key":"vmgjLM139u"}],"key":"EGYGPXPPR6"}],"key":"aodaSMZHXK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Monitoring Drought Dynamics","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BXyEN5spit"}],"identifier":"monitoring-drought-dynamics","label":"Monitoring Drought Dynamics","html_id":"monitoring-drought-dynamics","implicit":true,"key":"pt8KObtZFm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To track drought development in this exercise we will work with precipitation, soil moisture and vegetation data. The following dataset combines the HSAF ASCAT 6.25 surface soil moisture with data for precipitation from CHIRPS, and data for vegetation, the NDVI (see table).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VqJY6buLdq"}],"key":"KDKIRTFHj7"},{"type":"table","position":{"start":{"line":5,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Feature","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LhLX2bYwgQ"}],"key":"yYRFX9UHm1"},{"type":"tableCell","header":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"NDVI (Normalized Difference Vegetation Index)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NOn2zrHUXV"}],"key":"S6T5n5JW2W"},{"type":"tableCell","header":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"CHIRPS (Climate Hazards Group InfraRed Precipitation with Station data)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZIh3DjeiOf"}],"key":"j4tcHGhxpE"}],"key":"zIEVGPfOui"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Description","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"imlLrzFZF0"}],"key":"gokl0ZsRjM"}],"key":"W0xWlPBpzD"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"A widely used index to measure the health and vigor of vegetation (“greenness” of the biomes).","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cxgLkJoVzh"}],"key":"BWxQMPpHJQ"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"A high-resolution precipitation dataset that combines satellite and station data.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"j9K0auMruJ"}],"key":"lJ6y301sAv"}],"key":"UiVZmyev5y"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Data Source","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Uu70rsMfxH"}],"key":"NdqVZzsOI4"}],"key":"FnAvD2ivjG"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Remote sensing, typically from satellite imagery.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"DTn54Rt5IP"}],"key":"g5PklAeiQT"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Satellite infrared data combined with rain gauge station data.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"DvZdA4vTTR"}],"key":"BmjetNlSte"}],"key":"J6amCnQP7A"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Calculation","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"T0JPsKuclF"}],"key":"jVJKIg2QVH"}],"key":"PahHeUkFM2"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"(NIR - RED) / (NIR + RED), where NIR is Near-Infrared and RED is Red light reflectance.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BcxjCDguEI"}],"key":"JQX9QjCTXW"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Combines data from multiple sources to provide daily precipitation estimates.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"PviIMqBAYa"}],"key":"LBCU4fPorI"}],"key":"khXPGTBzKe"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Applications","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"tV9BMN39h7"}],"key":"ByBcM0g4y2"}],"key":"Ad4SZS9MQ5"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"- Agriculture: Monitoring crop health and growth.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"iW23ZC4okb"},{"type":"break","key":"Y4yuejeTo3"},{"type":"text","value":"- Ecology: Assessing vegetation cover and changes.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"eOF4dTrNYj"},{"type":"break","key":"w83J9Hq0Ep"},{"type":"text","value":"- Climate: Studying vegetation response to climate change.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"pj9VVDWkXQ"}],"key":"xDzB42zFqd"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"- Drought monitoring and early warning.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rrFedfYRZs"},{"type":"break","key":"oICzMdkRK1"},{"type":"text","value":"- Hydrological modeling.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"LBbsKCVyWl"},{"type":"break","key":"JsfgdFF2cF"},{"type":"text","value":"- Agricultural planning and risk management.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gGIMcMIdGy"}],"key":"BI0w4f9X3M"}],"key":"lEPVfj0ec9"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Advantages","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"SklhaT9huC"}],"key":"ppu6aqAcim"}],"key":"rXH6lwuLpI"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"- Simple and quick to calculate.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"WtpvbHFz8i"},{"type":"break","key":"ceG6ifnmIO"},{"type":"text","value":"- Provides a standardized measure of vegetation health.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"hAnQhP4qNx"},{"type":"break","key":"w2PwBqHJtK"},{"type":"text","value":"- Useful for temporal and spatial comparisons.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nDZtDzxUU8"}],"key":"dNscwds7JJ"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"- High spatial and temporal resolution.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Rbku84K3Uo"},{"type":"break","key":"PnQmCx3dgM"},{"type":"text","value":"- Integrates multiple data sources for better accuracy.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"PnwczoSZC3"},{"type":"break","key":"JwMcyuxIYA"},{"type":"text","value":"- Useful for regions with sparse rain gauge networks.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"JPZ9Xap3PA"}],"key":"IpWQcNv2vu"}],"key":"aybDFMIXNz"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Limitations","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HpjLTfWKNn"}],"key":"rSseCVa20p"}],"key":"gW0zTU2Lbu"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"- Sensitive to atmospheric conditions and soil background.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"LeXdrxzGrB"},{"type":"break","key":"OtwJj4dtzL"},{"type":"text","value":"- May require calibration for different vegetation types.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"pnV6ahw3N0"},{"type":"break","key":"UuwdjyXl5S"},{"type":"text","value":"- Does not distinguish between different types of vegetation.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"BIHrJz7Tdx"}],"key":"RSjjwCwevT"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"- Dependent on the quality and availability of input data.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"v84WiU0VfC"},{"type":"break","key":"jDSlu384KM"},{"type":"text","value":"- May have errors in areas with complex terrain or dense vegetation.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"XtBtApx8yV"},{"type":"break","key":"w9H8BZviZz"},{"type":"text","value":"- Requires validation with ground truth data.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"XvIkIAQtc8"}],"key":"Ra1KETL50r"}],"key":"OucR8EvEBI"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Use Cases","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"EGnWNRSlZj"}],"key":"qPqN66shzL"}],"key":"RgxTUO8vuu"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"- Detecting areas of stressed or unhealthy vegetation.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ds4pFvMqwx"},{"type":"break","key":"DsZJnmppt3"},{"type":"text","value":"- Monitoring deforestation and land use changes.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"OIIOOcMu2h"},{"type":"break","key":"ITcmZZfIBh"},{"type":"text","value":"- Assessing the impact of droughts and floods on vegetation.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"CaDEfjnQUM"}],"key":"sjPNwBNcQR"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"- Providing real-time precipitation data for disaster response.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"a6AAbTM8Vd"},{"type":"break","key":"uQQtsJOTKT"},{"type":"text","value":"- Supporting water resource management and irrigation planning.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"DXV3bd5BO0"},{"type":"break","key":"cHrUUyjchh"},{"type":"text","value":"- Enhancing climate models and weather forecasting.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"RpzClFhcDx"}],"key":"oSEU1hSvCM"}],"key":"sUtz6NDCAr"}],"key":"tHlJYbLxxh"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"In summary, NDVI indicates plant health based on the assumption that plants lose their greenness when they wilt due to water deprivation. However, this signal is highly dependent on vegetation types, soil background, and atmospheric conditions. CHIRPS measures precipitation and is affected by the quality of the input data, which can be problematic if there is a scarcity or poor quality of meteorological stations in a region.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"a7DETF67ZG"}],"key":"MEse0pnq6Z"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Let’s load the data as prepared for the notebook.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"gcbvLNda78"}],"key":"ak6D7eDnRe"}],"key":"xAmlY9HFjq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"url = make_url(\"drought_indices-6_25_dekadal.csv\")\ndf_dekadel = (\n    pd.read_csv(\n        url,\n        index_col=\"time\",\n        parse_dates=True,\n    )\n    .dropna()\n    .sort_index()\n)\n\ndf_dekadel.head()","key":"am89fjAt36"},{"type":"outputs","id":"unE-Ehj9K4LAUgnyaURtc","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"https://git.geo.tuwien.ac.at/api/v4/projects/1266/repository/files/drought_indices-6_25_dekadal.csv/raw?ref=main&lfs=true\n"},"key":"jgChbCztYE"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"            longitude   latitude  surface_soil_moisture   ndvi    precip  \\\ntime                                                                       \n2012-01-01  34.770840 -18.889309                0.30570  0.564  0.046854   \n2012-01-01  32.540100 -23.426407                0.29010  0.432  0.002876   \n2012-01-01  34.113262 -22.077436                0.31970  0.576  0.020926   \n2012-01-01  34.119698 -19.975350                0.31385  0.576  0.024297   \n2012-01-01  33.030777 -24.612324                0.19315  0.320  0.000000   \n\n                name  \ntime                  \n2012-01-01    Muanza  \n2012-01-01  Mabalane  \n2012-01-01    Mabote  \n2012-01-01      Buzi  \n2012-01-01    Chokwé  ","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>longitude</th>\n      <th>latitude</th>\n      <th>surface_soil_moisture</th>\n      <th>ndvi</th>\n      <th>precip</th>\n      <th>name</th>\n    </tr>\n    <tr>\n      <th>time</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2012-01-01</th>\n      <td>34.770840</td>\n      <td>-18.889309</td>\n      <td>0.30570</td>\n      <td>0.564</td>\n      <td>0.046854</td>\n      <td>Muanza</td>\n    </tr>\n    <tr>\n      <th>2012-01-01</th>\n      <td>32.540100</td>\n      <td>-23.426407</td>\n      <td>0.29010</td>\n      <td>0.432</td>\n      <td>0.002876</td>\n      <td>Mabalane</td>\n    </tr>\n    <tr>\n      <th>2012-01-01</th>\n      <td>34.113262</td>\n      <td>-22.077436</td>\n      <td>0.31970</td>\n      <td>0.576</td>\n      <td>0.020926</td>\n      <td>Mabote</td>\n    </tr>\n    <tr>\n      <th>2012-01-01</th>\n      <td>34.119698</td>\n      <td>-19.975350</td>\n      <td>0.31385</td>\n      <td>0.576</td>\n      <td>0.024297</td>\n      <td>Buzi</td>\n    </tr>\n    <tr>\n      <th>2012-01-01</th>\n      <td>33.030777</td>\n      <td>-24.612324</td>\n      <td>0.19315</td>\n      <td>0.320</td>\n      <td>0.000000</td>\n      <td>Chokwé</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"}}},"key":"jbmRR2LqXB"}],"key":"QIxBRxQvd3"}],"key":"tPOpDS7UbN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We have five time series datasets spanning from 2011 to 2020 for the selected locations in the DrySat project, available for in-depth analysis (refer to notebooks 1 and 2). The NDVI data is sourced from the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CgwsIIOj27"},{"type":"link","url":"https://land.copernicus.eu/en/products/vegetation?tab=vegetation_indices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Copernicus Land Monitoring Service","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uD63UQSXUA"}],"urlSource":"https://land.copernicus.eu/en/products/vegetation?tab=vegetation_indices","key":"BMPWs2GkYk"},{"type":"text","value":", and the CHIRPS data is obtained from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vphz3RPspm"},{"type":"link","url":"https://climateserv.servirglobal.net","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ClimateSERV","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HWQorVZusf"}],"urlSource":"https://climateserv.servirglobal.net","key":"hSoSBoZmX9"},{"type":"text","value":". NDVI values range from 0 to 1 and are often classified as follows:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RMWQBsTQIp"}],"key":"sYWVPePHuq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"0 to 0.1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gGdr577Agt"}],"key":"NvpoRJDMah"},{"type":"text","value":": Bare soil, rock, or sand.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bAoecdeG9Z"}],"key":"d5jrb9YpE9"}],"key":"n7GSk5dtJJ"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"0.1 to 0.2","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"oXkv1jvHN9"}],"key":"WbdM2Ma0U4"},{"type":"text","value":": Low vegetation or senescent (dying) vegetation.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Y7xDRHO6SL"}],"key":"YsoXB68seO"}],"key":"Dbhby23OXn"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"0.2 to 0.5","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jifwbRgeYy"}],"key":"HMumOvnfXP"},{"type":"text","value":": Sparse vegetation, such as shrubs and grasslands.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mLEQT1O4V2"}],"key":"BraVYOL7st"}],"key":"iLoxDNkgP6"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"0.5 to 0.7","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"P8QBuQACdM"}],"key":"Oz1blldTSA"},{"type":"text","value":": Moderate to high vegetation, such as crops and forests.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"XbaU9MDVlN"}],"key":"HzFNM3xIwr"}],"key":"KFNmYDnfNV"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"0.7 to 1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JdfssyaCnQ"}],"key":"TXi0ftPQZL"},{"type":"text","value":": High density of green leaves, indicative of very healthy vegetation.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CCfgS9rq9F"}],"key":"B2R5chMOFb"}],"key":"YTURLE9Shb"}],"key":"MggbVMg109"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"For this analysis, the ASCAT H SAF surface soil moisture (SSM) data, originally at a 6.25 km resolution and expressed as a percentage of saturation, is converted to a unit scale ranging from 0 to 1. Additionally, the CHIRPS precipitation data, measured in millimeters, is min-max scaled for each location’s time series individually to also range between 0 and 1.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"KSWgoUaA1g"}],"key":"WL0F7XhLzG"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Both NDVI and CHIRPS datasets are natively 10-daily products (or ‘dekadal’), while the SSM data is resampled to match this dekadal frequency.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CEPGQ94sYD"}],"key":"mLJCHFFkLG"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Let’s have a look at the data for each site individually with ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"p9qcYg5ZCI"},{"type":"inlineCode","value":"hvplot","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"pCPb8BRB1r"},{"type":"text","value":" use the dropdown menu “name” to select the preferred site.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"eOLMEAGtyb"}],"key":"V9vsdwAcRk"}],"key":"q0jH5cKVYI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_dekadel.hvplot.line(\n    x=\"time\",\n    y=[\"precip\", \"surface_soil_moisture\", \"ndvi\"],\n    subcoordinate_y=True,\n    groupby=[\"name\"],\n    frame_width=800,\n)","key":"f4FhifzVGH"},{"type":"outputs","id":"f12b8xwOCdQ4aHFXgDo7u","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{}},"key":"cfdARNI2Lz"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":3,"metadata":{"application/vnd.holoviews_exec.v0+json":{"id":"7f66319f-8d04-4114-9c3b-b2b617b73a96"}},"data":{"text/html":{"content_type":"text/html","hash":"7c3a750bd0d0ce00c924cb58ff040cb0","path":"/eo-datascience-cookbook/build/7c3a750bd0d0ce00c924cb58ff040cb0.html"},"application/vnd.holoviews_exec.v0+json":{"content":"","content_type":"application/vnd.holoviews_exec.v0+json"},"text/plain":{"content":":DynamicMap   [name]\n   :NdOverlay   [Variable]\n      :Curve   [time]   (value)","content_type":"text/plain"}}},"key":"LL2EhFMoIa"}],"key":"t5NH8WNR2E"}],"key":"KmfTvs1sDW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"By examining the three variables—CHIRPS precipitation (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N1cQx7RZvI"},{"type":"inlineCode","value":"precip","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kB6z0pXP6q"},{"type":"text","value":"), H SAF surface soil moisture (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cux1aZqGBC"},{"type":"inlineCode","value":"surface_soil_moisture","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aSsSZZPOwH"},{"type":"text","value":"), and NDVI (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Psz96WV56E"},{"type":"inlineCode","value":"ndvi","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MclOXomqkL"},{"type":"text","value":")—we observe a strong temporal correlation among them. This correlation is logical, as we expect rain to wet the soil, which in turn nourishes plant life, and vice versa. The most significant changes in these variables appear to be linked to transitions between dry and wet seasons.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LI6SoMdmbX"}],"key":"mlFTHUjtfL"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Exploration with Linear Regression","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cbebAVaMzv"}],"identifier":"exploration-with-linear-regression","label":"Exploration with Linear Regression","html_id":"exploration-with-linear-regression","implicit":true,"key":"I2SYqjF1SI"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Let’s delve deeper into the relationships among these three variables. Linear regression, specifically Ordinary Least Squares (OLS) regression, is a powerful tool for explanatory data analysis. OLS is a good starting point for your analysis as it is easy to interpret; the coefficients directly relate changes in the response variable to one-unit changes in the predictor variables, with the sign and magnitude reflecting the model’s effects. In an OLS regression, these effects refer to the impact of the independent variables on the dependent variable.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CRoWNwML2o"}],"key":"CsritzYHXC"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Although the assumptions underlying OLS regression (such as linearity, independence of observations, and normality of residuals) are likely to be violated, especially in time series analysis where observations closely spaced in time are likely to be dependent on each other (autocorrelation), we can still use OLS for an ad hoc analysis of the previously observed physical relationships. Specifically, we aim to test the following relationships:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Jf3hh5AE4b"}],"key":"U0MoqaSUTu"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"More rain leads to healthier vegetation.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"aDpjVCg4a4"}],"key":"FAerTF7xTc"}],"key":"dXm74advDK"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Wetter soils lead to healthier vegetation.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"e30maxyDdp"}],"key":"p7JJsKI9xp"}],"key":"AwBsVGMr2I"}],"key":"C8abG7Q12T"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"These relationships are intuitively important causal factors. To determine which best explains the dependent variable (NDVI), we will perform OLS regression using the ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"nLqLjr8mQc"},{"type":"inlineCode","value":"statsmodels","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ECf1OIz812"},{"type":"text","value":" package. Note that other Python packages, like ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"wX3YCFkITl"},{"type":"inlineCode","value":"scipy.stats","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"OOViVKieuw"},{"type":"text","value":", are also available.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Xfw0VsNl4T"}],"key":"qCu6OXc0xS"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"We’ll utilize ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"C503jqrxCu"},{"type":"inlineCode","value":"statsmodels","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"eAajkrWPQw"},{"type":"text","value":"’ formula interface, which allows specifying models with formula strings and directly using ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"TrQYd8D9Ks"},{"type":"inlineCode","value":"pandas.DataFrames","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"yc0CRDGHfX"},{"type":"text","value":". This interface employs a tilde (","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ZEopBUEjPL"},{"type":"inlineCode","value":"~","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"XQzL1xU019"},{"type":"text","value":") to separate the dependent variable from the independent variables. Interactions between variables can be specified using the ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Kd7jdsdc7b"},{"type":"inlineCode","value":"*","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"V5vdTwuMv0"},{"type":"text","value":" or ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Ux2aYbgC6C"},{"type":"inlineCode","value":":","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"K5CDAqIndI"},{"type":"text","value":" operators, enabling easy expansion to multiple regression. It also simplifies variable transformations and polynomial terms.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"naA845I8TQ"}],"key":"CtDqbRSleS"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"To translate the equation:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"cofEI9Un3f"}],"key":"tzLMGsmi3n"},{"type":"math","value":"\\text{NDVI} = \\alpha + \\beta \\text{CHIRPS} + \\epsilon","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>NDVI</mtext><mo>=</mo><mi>α</mi><mo>+</mo><mi>β</mi><mtext>CHIRPS</mtext><mo>+</mo><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\text{NDVI} = \\alpha + \\beta \\text{CHIRPS} + \\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">NDVI</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mord text\"><span class=\"mord\">CHIRPS</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span></span>","enumerator":"1","key":"j4OO4n5quj"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"into an ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"XEp4wF4zGY"},{"type":"inlineCode","value":"statsmodels","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"O7n58nDky0"},{"type":"text","value":" formula, you use:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Ey5PLxmmYR"}],"key":"G4H8WGNdUr"}],"key":"jpIQ7ldxpI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_buzi = df_dekadel[df_dekadel.name == \"Buzi\"]\nmod_precip = smf.ols(formula=\"ndvi ~ precip\", data=df_buzi)","key":"i87tt7rHW4"},{"type":"outputs","id":"Z6NoGrVEtVRKQ7Qjewdy1","children":[],"key":"rVFccyusVW"}],"key":"f96cdpSMTv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this context, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NAcAODQuYi"},{"type":"inlineCode","value":"ndvi","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bty6MuR7SG"},{"type":"text","value":" is the dependent variable, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eN7NGm5T56"},{"type":"inlineCode","value":"precip","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mja1MoOsPI"},{"type":"text","value":" is the independent variable, and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JSbEfzgphI"},{"type":"inlineCode","value":"df_buzi","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yYCjL4scFY"},{"type":"text","value":" is the data frame containing your data. We will focus on the Buzi region for the OLS regression and subsequent analysis.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CRTCk4Ltci"}],"key":"OjLjllPXKL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To fit the model, simply call the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GXmzNaD58x"},{"type":"inlineCode","value":"fit","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QnTRdm2bce"},{"type":"text","value":" method on the generated object. We will then print the parameters and their estimated coefficients as well as the variation in NDVI explained by the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LKovsADpkP"},{"type":"inlineMath","value":"R^2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">R^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"ojU1jYsFpe"},{"type":"text","value":" value.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"y2QQxn7jit"}],"key":"YHm1nWqWoA"}],"key":"Xa83GImPvK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"res_precip = mod_precip.fit()\n\nprint(\"Parameters: \\n\", res_precip.params, sep=\"\")\nprint(\"R2: \", res_precip.rsquared)","key":"CyiS4UUTSe"},{"type":"outputs","id":"tbmVFFFsjmiEYgD7F9L1v","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Parameters: \nIntercept    0.531179\nprecip       0.249106\ndtype: float64\nR2:  0.08314849453004114\n"},"key":"UpKe4Pbd8l"}],"key":"DT1diLuHVw"}],"key":"t37b5n8ky5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can see that the model fit with CHIRPS precipitation as independent variable is limited. Now let’s do the same for the second predefined relationship, where we translate (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KeTvkhhd5H"},{"type":"inlineMath","value":"\\text{NDVI} = \\alpha + \\beta \\text{SSM} + \\epsilon","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>NDVI</mtext><mo>=</mo><mi>α</mi><mo>+</mo><mi>β</mi><mtext>SSM</mtext><mo>+</mo><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\text{NDVI} = \\alpha + \\beta \\text{SSM} + \\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">NDVI</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mord text\"><span class=\"mord\">SSM</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"xi11KFrN8o"},{"type":"text","value":") into an ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wFAitpyYwh"},{"type":"inlineCode","value":"statsmodels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"elS8l1D9zj"},{"type":"text","value":" formula and asses it’s fit, like so:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PCKIZ2MFIc"}],"key":"MoTjsNt2Oo"}],"key":"SFmljxNoNG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mod_ssm = smf.ols(formula=\"ndvi ~ surface_soil_moisture\", data=df_buzi)\nres_ssm = mod_ssm.fit()\n\nprint(\"Parameters: \\n\", res_ssm.params, sep=\"\")\nprint(\"R2: \", res_ssm.rsquared)","key":"ylnd0gSaxi"},{"type":"outputs","id":"fATUOPBdxIdTpjDRL2puj","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Parameters: \nIntercept                0.346452\nsurface_soil_moisture    0.740606\ndtype: float64\nR2:  0.5374351087887564\n"},"key":"VLupTpdgTm"}],"key":"gYXQl25HLD"}],"key":"BqAsTIKxXX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This approach provides better results, explaining nearly 50% of the variance in NDVI with H SAF ASCAT SSM. Additionally, we can visualize these results using an ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WND4EPgnXD"},{"type":"inlineMath","value":"R^2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">R^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"LeSwpZhOQk"},{"type":"text","value":" plot to perform a more detailed diagnostic analysis of the model’s performance. We have predefined and loaded this function at the top of the notebook for clarity.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xd8QZ5FGPU"}],"key":"XhfhfK1Kar"}],"key":"PWfLTW8690"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"results = {\"precip\": res_precip, \"surface_soil_moisture\": res_ssm}\nplot_predicted_values(\n    df_buzi,\n    results,\n    figsize=(10, 5),\n)","key":"daxk5oGF1b"},{"type":"outputs","id":"hzo1Ug9IYWOEig7ttzfWM","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"32d23778402900136be64e38a2b9eeb4","path":"/eo-datascience-cookbook/build/32d23778402900136be64e38a2b9eeb4.png"}}},"key":"LtDF8yTrz7"}],"key":"gBMwcykdDW"}],"key":"XI35Mmn4V5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Leads and Lags of Water Availability and Vegetation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Cu3462HrEa"}],"identifier":"leads-and-lags-of-water-availability-and-vegetation","label":"Leads and Lags of Water Availability and Vegetation","html_id":"leads-and-lags-of-water-availability-and-vegetation","implicit":true,"key":"DmwikztlI3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"At the beginning of the notebook, we highlighted that droughts are cascading events where a lack of rain leads to reduced soil moisture, which in turn affects plant health. To study the dynamics of these cascading droughts, we should first examine the effects of precipitation and soil moisture on vegetation under normal conditions. We need to consider both the lead and lag of the respective causes and effects in this system. Precipitation leads, soil moisture replenishment lags, and vegetation responds with a delay to rainfall events.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QXxkMP9HIL"}],"key":"bOnEGBlTBH"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Though the cyclical nature of NDVI, H SAF ASCAT SSM, and CHIRPS precipitation is evident, these cycles correspond to the dry and wet seasons experienced in Mozambique. To quantify the actual periodicity of these seasons, autocorrelation is a useful tool. Autocorrelation in time series refers to the correlation of a time series with a delayed copy of itself, measuring the extent to which a time series value is linearly related to its past and future values. The following animation visually demonstrates how a copy of the time series is shifted alongside itself, illustrating the corresponding correlation, known as autocorrelation. This can be expressed as:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uyjs3bzTWi"}],"key":"XPCK7L8zJ5"},{"type":"math","value":"r_k = \\frac{\\sum_{t=1}^{N-k}{(x_t-\\bar{x} )(x_{t+k} -\\bar{x})}}{\\sum_{t=1}^N{(x_t-\\bar{x}})}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>r</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>N</mi><mo>−</mo><mi>k</mi></mrow></munderover><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>−</mo><mover accent=\"true\"><mi>x</mi><mo>ˉ</mo></mover><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub><mo>−</mo><mover accent=\"true\"><mi>x</mi><mo>ˉ</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>−</mo><mover accent=\"true\"><mi>x</mi><mo>ˉ</mo></mover></mrow><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">r_k = \\frac{\\sum_{t=1}^{N-k}{(x_t-\\bar{x} )(x_{t+k} -\\bar{x})}}{\\sum_{t=1}^N{(x_t-\\bar{x}})}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.8497em;vertical-align:-1.1709em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6787em;\"><span style=\"top:-2.1288em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9812em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5678em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6897em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.989em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5678em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5678em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1709em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"2","key":"sT99bZudf6"}],"key":"dyLFmni7qW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_step_corr(df_buzi, \"ndvi\", length=72)","key":"lhYYC2CaFx"},{"type":"outputs","id":"RwNWudggKY5sTQtyU4rWG","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"28c7004dae33481fc33fcbf99a0cc76c","path":"/eo-datascience-cookbook/build/28c7004dae33481fc33fcbf99a0cc76c.html"}}},"key":"diItvtvaXp"}],"key":"kocnIuJMvC"}],"key":"lK29KwO7Ig"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As expected, it takes 18 lags (or 18 dekads, equivalent to approximately half a year) for the signal to become almost entirely anti-correlated. It then takes 36 lags (or 36 dekads, equivalent to approximately 1 year) for the cycle to complete and the signal to become almost perfectly correlated again.  You can perform you own autocorrelation test with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qF7shwFCyu"},{"type":"inlineCode","value":"statsmodels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LppLY9lW25"},{"type":"text","value":", like so:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tbNOE1oLVR"}],"key":"Z61Ooun1iJ"}],"key":"JTUbYuP67l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"smt.acf(df_buzi.ndvi, nlags=4)","key":"NfRDOz8gmU"},{"type":"outputs","id":"G8mUuCCyOsmJwgY5KcYZi","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"array([1.        , 0.94896775, 0.88434477, 0.79925742, 0.69430392])","content_type":"text/plain"}}},"key":"ZmPkvPo1SW"}],"key":"mK4Z1A2qs0"}],"key":"PC48VWvlpZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Similarly, we can compare the lagged time series of CHIRPS precipitation with NDVI and the lagged time series of H SAF ASCAT SSM with NDVI. This type of analysis is known as lagged cross-correlation analysis. The following two animations illustrate the cross-correlations of H SAF ASCAT SSM with NDVI and CHIRPS precipitation with NDVI respectively.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EekPH08wkR"}],"key":"NK0WulA4ok"}],"key":"g3ZTXCH0DA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_step_corr(df_buzi, \"ndvi\", \"precip\", length=72)","key":"RwFS8d12tY"},{"type":"outputs","id":"KgN6d7Gefrd7KrGSraqr-","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"7b20b14cb5707d6dfc4c8fc8d82a1c18","path":"/eo-datascience-cookbook/build/7b20b14cb5707d6dfc4c8fc8d82a1c18.html"}}},"key":"nIA1YNI5t4"}],"key":"x3tqFOnraI"}],"key":"t30vhwpei4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_step_corr(df_buzi, \"ndvi\", \"surface_soil_moisture\", length=72)","key":"EkuOcRDPU7"},{"type":"outputs","id":"1v150RwLoCJQqbJp_spCQ","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"abc3e189cb50eaf1fe07f36acec05422","path":"/eo-datascience-cookbook/build/abc3e189cb50eaf1fe07f36acec05422.html"}}},"key":"bgNZQnVK9j"}],"key":"jNQGtkdHsU"}],"key":"clQBqK5mLf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We observe that these wet-dry cycles do not perfectly align among the two variables in our analysis. In both cases, the correlation initially increases with 3 to 6 lags in the time series for CHIRPS precipitation and H SAF SSM, respectively.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dh8QEkaM7B"}],"key":"yBpShxS7n7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"NDVI lags CHIRPS precipitation by 6 dekads (or approximately 2 months).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"niETazlA54"}],"key":"j2vNYS5xLv"}],"key":"aimP5k7ITY"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"NDVI lags H SAF SSM by 3 dekads (or approximately 1 month).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"muYRaB2DLl"}],"key":"TzK0Xa4VG1"}],"key":"rJC2Qfquua"}],"key":"xCmdTT5EFp"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"You can again perform you own lagged cross-correlation test with ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"oV0DganlSn"},{"type":"inlineCode","value":"statsmodels","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LpwWipOU7m"},{"type":"text","value":", like so:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"aiEN4ZuTRV"}],"key":"UhlLrkfFzF"}],"key":"cnRAtMLo4m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"smt.ccf(df_buzi.ndvi, df_buzi.surface_soil_moisture, nlags=4)  # for example","key":"NT4p88OY1h"},{"type":"outputs","id":"-nPKvMbkldBlhrMvN1VD-","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"array([0.73309966, 0.82333965, 0.86011595, 0.87138539])","content_type":"text/plain"}}},"key":"QCdD3J2JMm"}],"key":"DIW7oDa8u1"}],"key":"vTJSAp1u90"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Lagged Variable Regression","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zONpR2mcCE"}],"identifier":"lagged-variable-regression","label":"Lagged Variable Regression","html_id":"lagged-variable-regression","implicit":true,"key":"D1h60jos2i"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now that we’ve determined the appropriate lag, we can revisit the OLS regression. By using pandas’ ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YTIeYxuP49"},{"type":"inlineCode","value":"shift","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hpEi6OvnWs"},{"type":"text","value":" function, we adjust ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qMcZHZq1k4"},{"type":"inlineCode","value":"precip","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tMPWWmccba"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HudEhL7WWH"},{"type":"inlineCode","value":"surface_soil_moisture","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dQCCFg4e1j"},{"type":"text","value":" accordingly and then apply the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XPIVwJm1OR"},{"type":"inlineCode","value":"statsmodels","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AjyIwYqfeB"},{"type":"text","value":" OLS regression to the lagged dataset.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZohnfJ3pMr"}],"key":"CVLoMciZBK"}],"key":"fvXv8rVFno"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_buzi_shift = df_buzi.assign(\n    surface_soil_moisture=df_buzi.loc[:, \"surface_soil_moisture\"].shift(3),\n    precip=df_buzi.loc[:, \"precip\"].shift(6),\n).dropna()\n\ndf_buzi_shift","key":"ZlUjoJ8MzV"},{"type":"outputs","id":"EYX8GhAlJeTrxUQNUQ57n","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"            longitude  latitude  surface_soil_moisture   ndvi    precip  name\ntime                                                                         \n2012-03-01  34.119698 -19.97535                0.26675  0.608  0.024297  Buzi\n2012-03-11  34.119698 -19.97535                0.27485  0.636  0.375177  Buzi\n2012-03-21  34.119698 -19.97535                0.13000  0.580  0.154025  Buzi\n2012-04-01  34.119698 -19.97535                0.36055  0.688  0.053977  Buzi\n2012-04-11  34.119698 -19.97535                0.29830  0.676  0.244914  Buzi\n...               ...       ...                    ...    ...       ...   ...\n2019-11-11  34.119698 -19.97535                0.13205  0.336  0.022271  Buzi\n2019-11-21  34.119698 -19.97535                0.15360  0.528  0.020403  Buzi\n2019-12-01  34.119698 -19.97535                0.17110  0.544  0.074502  Buzi\n2019-12-11  34.119698 -19.97535                0.20390  0.600  0.009415  Buzi\n2019-12-21  34.119698 -19.97535                0.30400  0.632  0.035159  Buzi\n\n[282 rows x 6 columns]","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>longitude</th>\n      <th>latitude</th>\n      <th>surface_soil_moisture</th>\n      <th>ndvi</th>\n      <th>precip</th>\n      <th>name</th>\n    </tr>\n    <tr>\n      <th>time</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2012-03-01</th>\n      <td>34.119698</td>\n      <td>-19.97535</td>\n      <td>0.26675</td>\n      <td>0.608</td>\n      <td>0.024297</td>\n      <td>Buzi</td>\n    </tr>\n    <tr>\n      <th>2012-03-11</th>\n      <td>34.119698</td>\n      <td>-19.97535</td>\n      <td>0.27485</td>\n      <td>0.636</td>\n      <td>0.375177</td>\n      <td>Buzi</td>\n    </tr>\n    <tr>\n      <th>2012-03-21</th>\n      <td>34.119698</td>\n      <td>-19.97535</td>\n      <td>0.13000</td>\n      <td>0.580</td>\n      <td>0.154025</td>\n      <td>Buzi</td>\n    </tr>\n    <tr>\n      <th>2012-04-01</th>\n      <td>34.119698</td>\n      <td>-19.97535</td>\n      <td>0.36055</td>\n      <td>0.688</td>\n      <td>0.053977</td>\n      <td>Buzi</td>\n    </tr>\n    <tr>\n      <th>2012-04-11</th>\n      <td>34.119698</td>\n      <td>-19.97535</td>\n      <td>0.29830</td>\n      <td>0.676</td>\n      <td>0.244914</td>\n      <td>Buzi</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>2019-11-11</th>\n      <td>34.119698</td>\n      <td>-19.97535</td>\n      <td>0.13205</td>\n      <td>0.336</td>\n      <td>0.022271</td>\n      <td>Buzi</td>\n    </tr>\n    <tr>\n      <th>2019-11-21</th>\n      <td>34.119698</td>\n      <td>-19.97535</td>\n      <td>0.15360</td>\n      <td>0.528</td>\n      <td>0.020403</td>\n      <td>Buzi</td>\n    </tr>\n    <tr>\n      <th>2019-12-01</th>\n      <td>34.119698</td>\n      <td>-19.97535</td>\n      <td>0.17110</td>\n      <td>0.544</td>\n      <td>0.074502</td>\n      <td>Buzi</td>\n    </tr>\n    <tr>\n      <th>2019-12-11</th>\n      <td>34.119698</td>\n      <td>-19.97535</td>\n      <td>0.20390</td>\n      <td>0.600</td>\n      <td>0.009415</td>\n      <td>Buzi</td>\n    </tr>\n    <tr>\n      <th>2019-12-21</th>\n      <td>34.119698</td>\n      <td>-19.97535</td>\n      <td>0.30400</td>\n      <td>0.632</td>\n      <td>0.035159</td>\n      <td>Buzi</td>\n    </tr>\n  </tbody>\n</table>\n<p>282 rows × 6 columns</p>\n</div>","content_type":"text/html"}}},"key":"zkqqgF8ZJx"}],"key":"huQmQC3Wsp"}],"key":"UsQEvuIXbM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Thee lagged values of precipitation to account for the delayed impact of rainfall on vegetation health would look something like this:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MN1F6GmA3r"}],"key":"KicL0ADLPb"},{"type":"math","value":"\\text{NDVI}_t = \\alpha + \\beta \\text{CHIRPS}_{t-6} + \\epsilon_t","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mtext>NDVI</mtext><mi>t</mi></msub><mo>=</mo><mi>α</mi><mo>+</mo><mi>β</mi><msub><mtext>CHIRPS</mtext><mrow><mi>t</mi><mo>−</mo><mn>6</mn></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\text{NDVI}_t = \\alpha + \\beta \\text{CHIRPS}_{t-6} + \\epsilon_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">NDVI</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9028em;vertical-align:-0.2083em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">CHIRPS</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">6</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"3","key":"fSDCOV6vkb"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this equation, ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"P2UxArTSXk"},{"type":"inlineMath","value":"\\text{NDVI}_t","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mtext>NDVI</mtext><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\text{NDVI}_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">NDVI</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FZ0NN22ppF"},{"type":"text","value":"​ is the dependent variable at time ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TCw7XIUz8U"},{"type":"inlineMath","value":"t","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"sPu6ksIbfL"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mncvz3OZaT"},{"type":"inlineMath","value":"\\text{CHIRPS}_{t-6}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mtext>CHIRPS</mtext><mrow><mi>t</mi><mo>−</mo><mn>6</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\text{CHIRPS}_{t-6}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">CHIRPS</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">6</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZRJu3THcHd"},{"type":"text","value":" is the 6 dekadal lagged independent variables with ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"h8sV8J00RK"},{"type":"inlineMath","value":"\\beta","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span>","key":"wfv4STyU99"},{"type":"text","value":" as the coefficient. This approach can provide insights into how past events influence current outcomes, making it a valuable tool for time series analysis. We implement this as follows:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"m6Dcfy7Z5R"}],"key":"YWQmqMO00O"}],"key":"FU7UsqlGMs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mod_precip_shift = smf.ols(formula=\"ndvi ~ precip\", data=df_buzi_shift)\nres_precip_shift = mod_precip_shift.fit()\n\nprint(\"Parameters: \\n\", res_precip_shift.params, sep=\"\")\nprint(\"R2: \", res_precip_shift.rsquared)","key":"pZCb3QESFR"},{"type":"outputs","id":"pMw-eoXMzgHU26ZacMFHV","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Parameters: \nIntercept    0.503815\nprecip       0.479969\ndtype: float64\nR2:  0.3076670920100214\n"},"key":"Jg8vPvF2YO"}],"key":"SnhdUO9qZj"}],"key":"g74oVR0I1P"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We observe that including lagged rainfall data improves the model fits compared to a model without this information. Next, we will apply the same approach to H SAF SSM, now using a time lag of 3 dekads:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f2wdaPoeSe"}],"key":"ttKJYDqmYv"}],"key":"lWdzFKUjQs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mod_ssm_shift = smf.ols(formula=\"ndvi ~ surface_soil_moisture\", data=df_buzi_shift)\nres_ssm_shift = mod_ssm_shift.fit()\n\nprint(\"Parameters: \\n\", res_ssm_shift.params, sep=\"\")\nprint(\"R2: \", res_ssm_shift.rsquared)","key":"qBcGMGLHi5"},{"type":"outputs","id":"I-21rJhO-g6WnHK1mEj2_","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Parameters: \nIntercept                0.307934\nsurface_soil_moisture    0.874578\ndtype: float64\nR2:  0.74824179183522\n"},"key":"Es447jilIx"}],"key":"A2ZXijFfI4"}],"key":"elV0owXDjE"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here again the model fit improves over the model without lagged variables. We can perform a sanity check by plotting again the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bxDWxRQ64T"},{"type":"inlineMath","value":"R^2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">R^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"aMSQYIAfUt"},{"type":"text","value":" plots.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zEXeUXmYKt"}],"key":"vjr7M9KCik"}],"key":"xlpdXbDdbG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"results_shift = {\"precip\": res_precip_shift, \"surface_soil_moisture\": res_ssm_shift}\nplot_predicted_values(\n    df_buzi_shift,\n    results_shift,\n    figsize=(10, 5),\n    suffix=[\"(shifted 2 months)\", \"(shifted 1 month)\"],\n)","key":"YtGsaou9xE"},{"type":"outputs","id":"KHB7nCVtxUT-_17-mo1e7","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"267ebc6dcd456e85c3867572a2c57bea","path":"/eo-datascience-cookbook/build/267ebc6dcd456e85c3867572a2c57bea.png"}}},"key":"nqnAxHYj8N"}],"key":"F7G5XJWWw4"}],"key":"Okt3qnBwJZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"These ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HDJnxW7i3P"},{"type":"inlineMath","value":"R^2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">R^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"OZaBdr7OCi"},{"type":"text","value":" plots indicate that the relationships are better captured with lagged variables compared to unlagged ones. However, the precipitation data does not fully conform to the underlying principles of linear regression with OLS. It is quite obvious from this plot that rainfall data contains a lot of zeros. This should be addressed before one can make inferences from the model.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HYy84om3Mh"}],"key":"lrgDtqndrN"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Enhancing the Robustness of Lagged Variable OLS Analysis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yvcNO2KjLi"}],"identifier":"enhancing-the-robustness-of-lagged-variable-ols-analysis","label":"Enhancing the Robustness of Lagged Variable OLS Analysis","html_id":"enhancing-the-robustness-of-lagged-variable-ols-analysis","implicit":true,"key":"Y2xFtV7Lvu"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"To advance the lagged variable analysis with Ordinary Least Squares (OLS), we need to consider several methodological enhancements. Here are strategies to take this forward:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CMHZDVgDqq"}],"key":"oeCnvKAUKf"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"BLUE Estimators","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EGvebChRy8"}],"key":"bDzYJdXHYh"},{"type":"text","value":":\nEnsure your models conform to the properties of BLUE estimators (Bias, Linearity, Uncorrelated errors, and Efficiency). This will provide the most reliable and unbiased estimates for your regression coefficients.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"d9Pei4Cv3w"}],"key":"QlWl4EVt41"}],"key":"UX4PaEtEBM"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Autocorrelation","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Shm9tR6c49"}],"key":"abKkCsMctq"},{"type":"text","value":":\nAutocorrelation can significantly affect the reliability of your model. We’ve already identified strong autocorrelation in the temporal domain using autocorrelation tests. Consider looking into Generalized Least Squares models, which can account for dependency structures in their residuals.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Em9CPGSQtu"}],"key":"S5cbpqgCUu"}],"key":"fFIaswOso9"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Multiple Independent Variables","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"W05m3oy3AW"}],"key":"bQRr2eUOnm"},{"type":"text","value":":\nIncorporate multiple independent variables, including both lagged and unlagged versions. For example, include precipitation, soil moisture, and other relevant factors with appropriate lag structures to capture their delayed effects.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Gd0du4rLpq"}],"key":"klU3vjVJfI"}],"key":"CfDmB6HvMB"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Non-normal Residuals","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"PDAZ4aNQOC"}],"key":"o9K6LgzqIU"},{"type":"text","value":":\nIf your residuals are not normally distributed, it can impact the validity of your hypothesis tests. Techniques such as transforming the dependent variable (e.g., using log or Box-Cox transformations), or using robust regression methods can help address this.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"tE9lXsfaju"}],"key":"QIuUctLHEu"}],"key":"uLTatAIvQy"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Non-linear Behavior","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"iTx8PUZKDu"}],"key":"hg3FKbKAFD"},{"type":"text","value":":\nIf you detect non-linear relationships, consider using polynomial regression or non-linear regression models. Interaction terms between your independent variables can also capture non-linear effects within an OLS framework.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"lOfAyaSI91"}],"key":"a3pYLGNHMQ"}],"key":"T9po0EaudO"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Model Diagnostics","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"tnoc8hUYBm"}],"key":"LwdHjIHVlq"},{"type":"text","value":":\nRegularly perform diagnostic checks on your models. Examine plots of residuals versus fitted values, histograms of residuals, and autocorrelation plots to ensure model assumptions are met and identify areas for improvement.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"OsZw0blZSQ"}],"key":"q58nmLdJ6X"}],"key":"atSIjnGaf4"}],"key":"kn4GNaJyZz"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"By adopting these strategies, you will significantly enhance the robustness of your lagged variable OLS analysis, ensuring it is both methodologically sound and practically useful for understanding and predicting complex dynamic systems. Ultimately, this will help us better comprehend the normal wet/dry dynamics of the system, allowing us to predict the effects of current drought conditions on crops and subsequently help forecast yield.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"JAo95QtsWA"}],"key":"TCyuv5aJbf"}],"key":"w9eUuhQCjS"}],"key":"yr3hL9ti8P"},"references":{"cite":{"order":["Crocetti_2020"],"data":{"Crocetti_2020":{"label":"Crocetti_2020","enumerator":"1","doi":"10.1007/s10113-020-01710-w","html":"Crocetti, L., Forkel, M., Fischer, M., Jurečka, F., Grlj, A., Salentinig, A., Trnka, M., Anderson, M., Ng, W.-T., Kokalj, Ž., Bucur, A., & Dorigo, W. (2020). Earth Observation for agricultural drought monitoring in the Pannonian Basin (southeastern Europe): current state and future directions. <i>Regional Environmental Change</i>, <i>20</i>(4). <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s10113-020-01710-w\">10.1007/s10113-020-01710-w</a>","url":"https://doi.org/10.1007/s10113-020-01710-w"}}}},"footer":{"navigation":{"prev":{"title":"Evaluating the Reliability of Remotely Sensed Droughts","url":"/notebooks/courses/environmental-remote-sensing/unit-01/handout-drought-2","group":"Courses"},"next":{"title":"Templates","url":"/notebooks/templates/prereqs-templates","group":"Templates"}}},"domain":"http://localhost:3000"}