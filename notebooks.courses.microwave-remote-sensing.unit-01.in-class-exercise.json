{"version":3,"kind":"Notebook","sha256":"1ba6c403d5e6f648a2c9b6831fa19c99b3783690b6d64d7bc26d881a0affaa8b","slug":"notebooks.courses.microwave-remote-sensing.unit-01.in-class-exercise","location":"/notebooks/courses/microwave-remote-sensing/unit_01/01_in_class_exercise.ipynb","dependencies":[],"frontmatter":{"title":"Discover and Read SAR Data","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Wolfgang Wagner","given":"Wolfgang","family":"Wagner"},"name":"Wolfgang Wagner","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Martin Schobben","given":"Martin","family":"Schobben"},"name":"Martin Schobben","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Nikolas Pikall","given":"Nikolas","family":"Pikall"},"name":"Nikolas Pikall","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Joseph Wagner","given":"Joseph","family":"Wagner"},"name":"Joseph Wagner","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Davide Festa","given":"Davide","family":"Festa"},"name":"Davide Festa","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Felix David Reuß","given":"Felix David","family":"Reuß"},"name":"Felix David Reuß","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Luka Jović","given":"Luka","family":"Jović"},"name":"Luka Jović","id":"contributors-myst-generated-uid-6"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":2}},"exports":[{"format":"ipynb","filename":"01_in_class_exercise.ipynb","url":"/eo-datascience-cookbook/build/01_in_class_exercise-c5e53cb23dc4f983b81549a9a3b6200e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook demonstrates how to access radar data in a SpatioTemporal Asset Catalog (STAC) Catalogue using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M9ueF3Kj5n"},{"type":"inlineCode","value":"pystac","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AUxnAyhnFt"},{"type":"text","value":" library. In this example, we use Sentinel-1 data from the EODC (earth observation data and high performance computing service provider based in Vienna) STAC catalog. In the further process, we will learn how to query a STAC catalog, select specific items, and display the metadata and the actual image.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sDUV7WAm6i"}],"key":"OJQBlnrCTX"}],"key":"JKj2aH5LIP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import folium\nimport pystac_client\nfrom odc import stac as odc_stac","key":"M7LS1LHHRQ"},{"type":"outputs","id":"z_aju1KNnq7uK4q1E2MBy","children":[],"key":"FoJNqot6yg"}],"key":"G13LFIOGeE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Discovery","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TFMc0w47Fn"}],"identifier":"data-discovery","label":"Data Discovery","html_id":"data-discovery","implicit":true,"key":"BS94XxziJ7"}],"key":"TBUngsrmHR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"eodc_catalog = pystac_client.Client.open(\"https://stac.eodc.eu/api/v1\")\n\neodc_catalog","key":"rctnFmIF5B"},{"type":"outputs","id":"WExmPxHo24fjn91ECvVoI","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"<Client id=stac-fastapi>","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"cfe74d50c8827055d27dc4f7e00ea24a","path":"/eo-datascience-cookbook/build/cfe74d50c8827055d27dc4f7e00ea24a.html"}}},"key":"SaJXTGh312"}],"key":"Tgu74TRGLO"}],"key":"ByxhQ0BmbL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The URL ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o8Fck9meMi"},{"type":"inlineCode","value":"https://stac.eodc.eu/api/v1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ug2KmOmvEc"},{"type":"text","value":", served over Hypertext Transfer Protocol (HTTP), is a STAC-compliant API endpoint (specific URL address where an API service is available) that leads to the EODC Catalogue. Besides EODC’s, other catalogues can be found on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HPmlRBTfGX"},{"type":"link","url":"https://stacindex.org/catalogs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"STAC Index","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BcVlNuPLP2"}],"urlSource":"https://stacindex.org/catalogs","key":"nCRyzPloDI"},{"type":"text","value":", such as United States Geological Survey (USGS) Landsat imagery, Sentinel Hub, Copernicus Data Space Ecosystem, and so on. Briefly spoken, STAC can be used to search, discover, and access metadata of these datasets with the same code. The EODC Catalogue can be accessed on the web via this ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I2tjTGRt0d"},{"type":"link","url":"https://services.eodc.eu/browser/#/?.language=en","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"link","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xxz3qqR8Hp"}],"urlSource":"https://services.eodc.eu/browser/#/?.language=en","key":"N3ZvpLGhIB"},{"type":"text","value":" as well.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OKq1RvvG0O"}],"key":"pVWFzPJLCF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Each STAC catalog, composed by different providers, has many collections. To get all collections of a catalog, we can print all of them and their ids, which are used to fetch them from the catalog.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rXl5Iq41p9"}],"key":"EJVPmwnBJv"}],"key":"mBuKnWNpS6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"collections = eodc_catalog.get_collections()\n\n# length of string of collection.id, for pretty print\nmax_length = max(len(collection.id) for collection in collections)\n\nfor collection in eodc_catalog.get_collections():\n    print(f\"{collection.id.ljust(max_length)}: {collection.title}\")","key":"XAlayDzlHI"},{"type":"outputs","id":"hUpRYYyD3sP7GJiEnkYEt","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"AI4SAR_SIG0                      : AI4SAR Despeckled Sentinel-1 Sigma0 (20m)\nASA_IMP_1P                       : Envisat ASAR Image Mode Precision Level-1\nASA_IMS_1P                       : Envisat ASAR Image Mode Single Look Complex Level-1\nAUSTRIA_GROUND_MOTION            : Austria Ground Motion\nAUT_DEM                          : Austrian High Resolution DEM\nBOA_LANDSAT_8                    : Bottom of Atmosphere Landsat-8 at 30m resolution.\nBOA_SENTINEL_2                   : Bottom of Atmosphere Sentinel-2 at 10m resolution.\nCGLS_SSM_1KM                     : Copernicus Global Land Surface Soil Moisture\nCOP_DEM                          : Copernicus Digital Elevation Model (DEM)\nCORINE_LAND_COVER                : Corine Land Cover\nDOP_AUT_K_KLAGENFURT             : Digital Orthophotos (DOP) Austria - Land Kärnten: Orthofotos Flugblock Klagenfurt\nDOP_AUT_K_OSTTIROL               : Digital Orthophotos (DOP) Austria - Land Kärnten: Orthofotos Flugblock Osttirol\nDOP_AUT_K_TAMSWEG                : Digital Orthophotos (DOP) Austria - Land Kärnten: Orthofotos Flugblock Tamsweg\nDOP_AUT_K_VILLACH                : Digital Orthophotos (DOP) Austria - Land Kärnten: Orthofotos Flugblock Villach\nDOP_AUT_K_WOLFSBERG              : Digital Orthophotos (DOP) Austria - Land Kärnten: Orthofotos Flugblock Wolfsberg\nDOP_AUT_K_ZELL_AM_SEE            : Digital Orthophotos (DOP) Austria - Land Kärnten: Orthofotos Flugblock Zell am See\nDOP_AUT_K_ZELTWEG                : Digital Orthophotos (DOP) Austria - Land Kärnten: Orthofotos Flugblock Zeltweg\nDOP_AUT_ST_BISCHOFSHOFEN         : Digital Orthophotos (DOP) Austria - Land Steiermark: Orthophotos Flugblock Bischofshofen\nDOP_AUT_ST_GRAZ                  : Digital Orthophotos (DOP) Austria - Land Steiermark: Orthophotos Flugblock Graz\nDOP_AUT_ST_KLAGENFURT            : Digital Orthophotos (DOP) Austria - Land Steiermark: Orthophotos Flugblock Klagenfurt\nDOP_AUT_ST_MARIAZELL             : Digital Orthophotos (DOP) Austria - Land Steiermark: Orthophotos Flugblock Mariazell\nDOP_AUT_ST_MURTAL                : Digital Orthophotos (DOP) Austria - Land Steiermark: Orthophotos Flugblock Murtal\nDOP_AUT_ST_SUEDBURGENLAND        : Digital Orthophotos (DOP) Austria - Land Steiermark: Orthophotos Flugblock Suedburgenland\nDOP_AUT_ST_VILLACH               : Digital Orthophotos (DOP) Austria - Land Steiermark: Orthophotos Flugblock Villach\nDOP_AUT_ST_WINDISCHGARSTEN       : Digital Orthophotos (DOP) Austria - Land Steiermark: Orthophotos Flugblock Windischgarsten\nDROUGHT_VULNERABILITY            : Drought Vulnerability\nDSM_AUT                          : Austrian Digital Surface Model\nERS_ENVISAT_NRB                  : ERS-1/2 SAR and ENVISAT ASAR ARD Normalized Radar Backscatter (NRB)\nGFM                              : Global Flood Monitoring\nincal-hourly                     : INCA analysis hourly data (1km)\nINTRA_FIELD_CROP_GROWTH_POTENTIAL: Intra-field Crop Growth Potential\nRUCIO_SENTINEL2_MFCOVER          : Monthly Composite of Fraction of Vegetation Cover\nSAR_IMP_1P                       : ERS-1/2 SAR Image Mode Precision Level-1\nSAR_IMS_1P                       : ERS-1/2 SAR Image Mode Single Look Complex Level-1\nSENTINEL1_ALPS_WETSNOW           : Sentinel-1 Alps WetSnow\nSENTINEL1_GMR0                   : SENTINEL1 Radiometric Terrain Corrected Gamma Nought\nSENTINEL1_GRD                    : Sentinel-1 SAR L1 GRD\nSENTINEL1_GRD_COVERAGE           : Sentinel-1 Coverage Maps\nSENTINEL1_HPAR                   : SENTINEL1 Harmonic Parameters\nSentinel-1_Lacken_Extent         : SENTINEL-1 Lacken Extent\nSENTINEL1_MPLIA                  : SENTINEL1 Mean PLIA\nSentinel-1_Reed_Extent           : SENTINEL-1 Reed Extent\nSENTINEL1_SCENE_GMR0             : SENTINEL1 Scene-based Radiometric Terrain Corrected Gamma Nought\nSENTINEL1_SIG0_20M               : SENTINEL1 Sigma Nought (SIG0) Backscatter in 20 meter resolution\nSENTINEL1_SLC                    : Sentinel-1 SLC\nSentinel-2-Greenness-Austria     : Sentinel-2 Greenness Austria\nSENTINEL2_GRI_L1C                : Multi-Layer Copernicus Sentinel-2 GRI in L1C\nSENTINEL2_L1C                    : Sentinel-2 MSI Products: Level-1C data\nSENTINEL2_L1C_COVERAGE           : Sentinel-2 L1C Coverage Maps\nSENTINEL2_L2A                    : Sentinel-2 MSI Products: Level-2A data\nsentinel2-landsat8-l2f           : Harmonized Landsat and Sentinel 2 L2F\nSENTINEL2_MFCOVER                : Monthly Composite of Fraction of Vegetation Cover\nSENTINEL3_SRAL_L2                : Sentinel-3 Products: SRAL Level-2 data\nspartacus-daily                  : Spartacus Analysis Daily (1 km)\nSSM-RT0-SIG0-R-EXTR              : SSM-RT0-SIG0-R-EXTR\ntopo-dc-austria                  : Topographic datacube Austria\nVEGETATION_CHANGE_AUSTRIA        : Vegetation-Change-Austria\n"},"key":"dYbjdXujOA"}],"key":"uCUnsVBL40"}],"key":"rvysByXLkE"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To get a specific collection from the catalog, we can use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DtNSmXLjiy"},{"type":"inlineCode","value":"client.get_collection()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SS6WA9HVR9"},{"type":"text","value":" method and provide the collection name. We can then display its description, id, temporal and spatial extent, license, etc. In this notebook, we will work with the Sentinel-1 sigma naught 20m collection.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mgEXOt8AE0"}],"key":"vZG0GY0rlP"}],"key":"RT7nnVq6Sz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"colllection_id = \"SENTINEL1_SIG0_20M\"\n\ncollection = eodc_catalog.get_collection(colllection_id)\ncollection","key":"hEdCK70IDh"},{"type":"outputs","id":"XKpuMXZeoPmVXTCSue_Cc","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"<CollectionClient id=SENTINEL1_SIG0_20M>","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"d740a50b22f985020a7e00949a8780d9","path":"/eo-datascience-cookbook/build/d740a50b22f985020a7e00949a8780d9.html"}}},"key":"q0sJDcbt0z"}],"key":"HvNnfFxLfq"}],"key":"Dzx2QJqkOo"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Each collection has multiple items. An item is one spatio-temporal instance in the collection, for instance a satellite image. If items are needed for a specific timeframe or for a specific region of interest, we can define this as a query.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JeMfhJJL4H"}],"key":"dJwFxVhe74"}],"key":"nRNWSdWbBo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"time_range = \"2022-10-01/2022-10-07\"  # a closed range\n# time_range = \"2022-01\"  # whole month, same can be done for a year and a day\n# time_range = \"2022-01-01/..\"  # up to the current date, an open range\n# time_range = \"2022-01-01T05:34:46\"  # a specific time instance","key":"G8ITX0sHzW"},{"type":"outputs","id":"S4lFAxbNBQd2XWWN9bBIj","children":[],"key":"XaDU6iHrn3"}],"key":"XPbUfygpPI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A spatial region of interest can be defined in different ways. One option is to define a simple bounding box:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mNHruCWhlQ"}],"key":"DWcs4hCdKX"}],"key":"ZxTgpL6I2G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"latmin, latmax = 46.3, 49.3  # South to North\nlonmin, lonmax = 13.8, 17.8  # West to East\n\nbounding_box = [lonmin, latmin, lonmax, latmax]","key":"S4HhSpJVdy"},{"type":"outputs","id":"R61NUFRyAeKiw5N-kjt1b","children":[],"key":"ifqBUV0J1z"}],"key":"ASHKOHq9wC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If the region of interest is not rectangular, we can also define a polygon:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bAPkmht2dV"}],"key":"lzcIv9ZyRm"}],"key":"ZgUs26ZboJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# GEOJSON can be created on geojson.io\n\n# This specific area of interest is a rectangle, but since it is\n# a closed polygon it seems like it has five nodes\n\narea_of_interest = {\n    \"coordinates\": [\n        [\n            [17.710928010825853, 49.257630084442496],\n            [13.881798300915221, 49.257630084442496],\n            [13.881798300915221, 46.34747715326259],\n            [17.710928010825853, 46.34747715326259],\n            [17.710928010825853, 49.257630084442496],\n        ]\n    ],\n    \"type\": \"Polygon\",\n}","key":"NaocnnjI5Z"},{"type":"outputs","id":"GoXX9UiY5mvLd5qt72f_i","children":[],"key":"oLKTZtiykz"}],"key":"J4IhTu1P2f"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using our previously loaded STAC catalog, we can now search for items fullfilling our query. In this example we are using the bounding box. If we want to use an area of interest specified in the geojson format - one has to use the intersects parameter as documented in the comment below.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lEGJ8QVPwL"}],"key":"S78FJUwsmS"}],"key":"YotVU3cY8Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"search = eodc_catalog.search(\n    collections=colllection_id,  # can also be a list of several collections\n    bbox=bounding_box,  # search by bounding box\n    # intersects=area_of_interest,  # GeoJSON search\n    datetime=time_range,\n    # max_items=1  # number of max items to load\n)\n\n# If we comment everything besides colllection_id, we will load whole\n# collection for available region and time_range\n\nitems_eodc = search.item_collection()\nprint(f\"On EODC we found {len(items_eodc)} items for the given search query\")","key":"z4dYQLsPCE"},{"type":"outputs","id":"H5c-VGSf769irX6uzmKIh","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"On EODC we found 52 items for the given search query\n"},"key":"Rqjfy7BUvh"}],"key":"DGvqeeAzfh"}],"key":"q6dAN7yzhO"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, we can fetch a single item, in this case a Sentinel-1 image, from the query results. A good practice is to always check what metadata the data provider has stored on the item level. This can be done by looking into the item properties.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WsMLA5t6xn"}],"key":"EGxIKcZEOl"}],"key":"oC4hbTtZkm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"item = items_eodc[0]\nitem.properties","key":"mtIERpuwJf"},{"type":"outputs","id":"t95NikjKbe0bxIby9MtwM","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"{'gsd': 20,\n 'parent': 'S1A_IW_GRDH_1SDV_20221007T170811_20221007T170836_045339_056BBA_D830.zip',\n 'checksum': '576abe68a715e5ee177d8b640871e873',\n 'datetime': '2022-10-07T17:08:11Z',\n 'blocksize': {'x': 15000, 'y': 5},\n 'proj:bbox': [4800000, 1500000, 5100000, 1800000],\n 'proj:wkt2': 'PROJCS[\"Azimuthal_Equidistant\",GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"degree\",0.0174532925199433],AUTHORITY[\"EPSG\",\"4326\"]],PROJECTION[\"Azimuthal_Equidistant\"],PARAMETER[\"latitude_of_center\",53],PARAMETER[\"longitude_of_center\",24],PARAMETER[\"false_easting\",5837287.81977],PARAMETER[\"false_northing\",2121415.69617],UNIT[\"metre\",1,AUTHORITY[\"EPSG\",\"9001\"]]]',\n 'proj:shape': [15000, 15000],\n 'Equi7_TileID': 'EU020M_E048N015T3',\n 'constellation': 'sentinel-1',\n 'proj:geometry': {'type': 'Polygon',\n  'coordinates': [[[4800000.0, 1500000.0],\n    [4800000.0, 1800000.0],\n    [5100000.0, 1800000.0],\n    [5100000.0, 1500000.0],\n    [4800000.0, 1500000.0]]]},\n 'proj:transform': [20, 0, 4800000, 0, -20, 1800000],\n 'sat:orbit_state': 'ascending',\n 'sar:product_type': 'GRD',\n 'slice_gap_filled': False,\n 'sar:polarizations': ['VH', 'VV'],\n 'sar:frequency_band': 'C',\n 'sat:relative_orbit': 117,\n 'sar:instrument_mode': 'IW',\n 'border_noise_removed': True,\n 'sar:center_frequency': 5.405,\n 'sar:resolution_range': 40,\n 'thermal_noise_removed': True,\n 'sar:resolution_azimuth': 40,\n 'sar:pixel_spacing_range': 20,\n 'sar:observation_direction': 'right',\n 'sar:pixel_spacing_azimuth': 20,\n 'sat:platform_international_designator': '2014-016A'}","content_type":"text/plain"}}},"key":"iO5iA9I1pS"}],"key":"HJAVMxEFXt"}],"key":"l6x7vujilx"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For now, let’s display only the vertical-vertical (VV) polarized band of the item and some information about the data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zd2AN2FpIr"}],"key":"tX5YJrWHD7"}],"key":"uLqYOHpxxT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"item.assets[\"VV\"].extra_fields.get(\"raster:bands\")[0]","key":"Xr88ln9xDj"},{"type":"outputs","id":"OdFL3gVhEwtjT_WpccAo3","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"{'scale': 10,\n 'nodata': -9999,\n 'offset': 0,\n 'data_type': 'int16',\n 'spatial_resolution': 20}","content_type":"text/plain"}}},"key":"a39HIiUy6W"}],"key":"dEwkQ0KQps"}],"key":"lzU2qqkoqi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the EODC STAC catalogue an item can conveniently be displayed using its thumbnail.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KtWLPmS6A7"}],"key":"rMcfDVDEx4"}],"key":"NVsRkPegsb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"item.assets[\"thumbnail\"].href","key":"ntZeRJwiFo"},{"type":"outputs","id":"oUabgcME9ZygPix9Gwq7f","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"'https://data.eodc.eu/collections/SENTINEL1_SIG0_20M/V1M1R1/EQUI7_EU020M/E048N015T3/SIG0_20221007T170811__VV_A117_E048N015T3_EU020M_V1M1R1_S1AIWGRDH_TUWIEN.tif/thumbnail'","content_type":"text/plain"}}},"key":"Xi5DEBwEET"}],"key":"u759kUXA57"}],"key":"OnKRl7m8u5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we will plot the data on a map using the thumbnail and the python package ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xjddVhA8fc"},{"type":"link","url":"https://python-visualization.github.io/folium/latest/user_guide.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"folium","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zhSuwWYgs8"}],"urlSource":"https://python-visualization.github.io/folium/latest/user_guide.html","key":"bA7y4Jt9lW"},{"type":"text","value":". This is an easy way to quickly check how the data found by a search query looks on a map.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YgQHBuSn7j"}],"key":"EAZVHJFz8B"}],"key":"oLOkgm7aHv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"map = folium.Map(\n    location=[(latmin + latmax) / 2, (lonmin + lonmax) / 2],\n    zoom_start=7,\n    zoom_control=False,\n    scrollWheelZoom=False,\n    dragging=False,\n)\n\nfolium.GeoJson(area_of_interest, name=\"Area of Interest\").add_to(map)\n\nfor item in items_eodc:\n    # url leading to display of an item, can also be used as hyperlink\n    image_url = item.assets[\"thumbnail\"].href\n    bounds = item.bbox\n    folium.raster_layers.ImageOverlay(\n        image=image_url,\n        bounds=[[bounds[1], bounds[0]], [bounds[3], bounds[2]]],\n    ).add_to(map)\n\nfolium.LayerControl().add_to(map)\n\nmap","key":"Yc6rjDc6nF"},{"type":"outputs","id":"C7xVUvZT-akz-zteyXpB0","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"<folium.folium.Map at 0x7f34d7d38ec0>","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"039134d282d3679e5c6e30092965fdb3","path":"/eo-datascience-cookbook/build/039134d282d3679e5c6e30092965fdb3.html"}}},"key":"XJ8VyHlrRg"}],"key":"kS7HWdKNy1"}],"key":"YaT0VnFvjK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Figure 1: Map of study area. Blue rectangle is the area covered by the discovered data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mdDdqZ854R"}],"key":"a6YYozGiK5"}],"key":"IfBQ2GZ0aZ"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Data Reading","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AIkojMAab6"}],"identifier":"data-reading","label":"Data Reading","html_id":"data-reading","implicit":true,"key":"VftuYjeKCC"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"STAC can also be a useful tool for the discovery of data, however it only loads metadata. This saves memory, but if one would like to do further analysis, the data has to be loaded into memory or downloaded on disk.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kEEEt9YmHq"}],"key":"xQeen6mVeD"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In the following, we will demonstrate this with the library ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PtEs4J9ovq"},{"type":"inlineCode","value":"odc-stac","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nrbe6vWUSg"},{"type":"text","value":". Here we can define what data will loaded as ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PNaGdSVNGz"},{"type":"inlineCode","value":"bands","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zi1FTdtldB"},{"type":"text","value":"; in this case VV sigma naught. Moreover we can resample the data by providing any coordinate reference system (CRS) and resolution as well as a method for resampling of continuos data (e.g. bilinear resampling). In the example below we use the EQUI7 Grid of Europe and a 20 meter sampling. This is the native format of sigma naught stored at EODC, so there will be no actual resampling. Note, also, that resampling is not advisable for this data, as it is provided on a logarithmic scale. More about this in the notebook “Backscattering Coefficients”.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"U5y5AbUuoQ"}],"key":"T0TvxWluFC"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The chunks argument is an advancement method for performing parallel computations on the data. We will not cover this in further detail.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"MREzMMXKHA"}],"key":"Y6GXDYFyDw"}],"key":"eHqPqoUTfn"}],"key":"zF9j8kczSF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bands = \"VV\"  # Vertical-vertical polarized\ncrs = \"EPSG:27704\"  # Coordinate Reference System: EQUI7 Grid of Europe\nres = 20  # 20 meter\nchunks = {\"time\": 1, \"latitude\": 1000, \"longitude\": 1000}\nsig0_dc = odc_stac.load(\n    items_eodc,\n    bands=bands,\n    crs=crs,\n    resolution=res,\n    bbox=bounding_box,\n    chunks=chunks,\n    resampling=\"bilinear\",\n)","key":"NwIBORERdz"},{"type":"outputs","id":"4Y5zRyuiLpA7I8RPwtkTi","children":[],"key":"uYBETu43Zv"}],"key":"nnQ4QL2d8a"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s have a look at the VV polarized band of the dataset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zpk0RM5WjD"}],"key":"OaAM38um06"}],"key":"Ix9raI86uY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sig0_dc.VV","key":"uDAfCQFtdi"},{"type":"outputs","id":"V_mmnLsYHoxBoVe81NFOc","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"<xarray.DataArray 'VV' (time: 31, y: 18269, x: 16725)> Size: 19GB\ndask.array<VV, shape=(31, 18269, 16725), dtype=int16, chunksize=(1, 18269, 16725), chunktype=numpy.ndarray>\nCoordinates:\n  * time         (time) datetime64[ns] 248B 2022-10-01T05:09:56 ... 2022-10-0...\n  * y            (y) float64 146kB 1.762e+06 1.762e+06 ... 1.396e+06 1.396e+06\n  * x            (x) float64 134kB 5.052e+06 5.052e+06 ... 5.387e+06 5.387e+06\n    spatial_ref  int32 4B 27704\nAttributes:\n    nodata:   -9999","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"1d7d92d17d3f77ee96f4886772226ae7","path":"/eo-datascience-cookbook/build/1d7d92d17d3f77ee96f4886772226ae7.html"}}},"key":"dxNpJoww4J"}],"key":"HUIU6S4yZ2"}],"key":"qRuHBLOMHk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As we can see, the data is stored as a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"igQzveYJVB"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wSflzsxpza"},{"type":"text","value":" DataArray. Xarray is a convenient package for multidimensional labeled arrays, like temperature, humidity, pressure, different bands of satellite imagery, and so on. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yGzAtN6LZX"},{"type":"link","url":"https://docs.xarray.dev/en/stable/index.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The link","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L1lOkbrjDU"}],"urlSource":"https://docs.xarray.dev/en/stable/index.html","key":"DBbmtfwPBO"},{"type":"text","value":" provides detailed documentation. In a later notebook we will explore some more of the functionality of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AdGwJemWGp"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"skjr2Bcgrf"},{"type":"text","value":". As we can see in the coordinates, the data here consists of 21 time steps.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bdfQFnJoc0"}],"key":"zexoW2BRDG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In general, data from STAC is “lazily” loaded, which means that the structure of the DataArray is constructed, but the data is not loaded yet. It is loaded only at instance when it is needed, for example, for plotting, computations, and so on.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AaWw1yD7Fb"}],"key":"VoKFgn7jT2"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Since the DataArray has currently a size of almost 18 GiB, we will subset it to the region of Vienna.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XLWPPtxLyr"}],"key":"pEX23PguzI"}],"key":"s4kDxhB8lZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create a bounding box covering the region of Vienna\nlatmin_smaller, latmax_smaller = 48, 48.4\nlonmin_smaller, lonmax_smaller = 16, 16.5\n\nsmaller_bounding_box = [\n    [latmin_smaller, lonmin_smaller],\n    [latmax_smaller, lonmax_smaller],\n]\n\nmap = folium.Map(\n    location=[\n        (latmin_smaller + latmax_smaller) / 2,\n        (lonmin_smaller + lonmax_smaller) / 2,\n    ],\n    zoom_start=8,\n    zoom_control=False,\n    scrollWheelZoom=False,\n    dragging=False,\n)\n\nfolium.GeoJson(area_of_interest, name=\"Area of Interest\").add_to(map)\n\nfolium.Rectangle(\n    bounds=smaller_bounding_box,\n    color=\"red\",\n).add_to(map)\n\nfor item in items_eodc:\n    image_url = item.assets[\"thumbnail\"].href\n    bounds = item.bbox\n    folium.raster_layers.ImageOverlay(\n        image=image_url,\n        bounds=[[bounds[1], bounds[0]], [bounds[3], bounds[2]]],\n    ).add_to(map)\n\nfolium.LayerControl().add_to(map)\n\nmap","key":"Dik31uU3Oz"},{"type":"outputs","id":"P2ourbjpsQeVGabUidg1S","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"<folium.folium.Map at 0x7f34d78ad810>","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"1a113dc5bfd9f7b83f1d7de8e4bc5962","path":"/eo-datascience-cookbook/build/1a113dc5bfd9f7b83f1d7de8e4bc5962.html"}}},"key":"ym1dbmNs0n"}],"key":"JhqCEBaqt4"}],"key":"GcvmDjAI0n"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Figure 2: Map of study area. Blue rectangle is the area covered by the discovered data. Red rectangle covers the selected data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xJCCZjVYJG"}],"key":"GqO4PZq8po"}],"key":"iPv7NobO1G"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Create a new dataset with the smaller bounding box covering the region of Vienna. We will leave out the arguments for resampling and directly use the native format as defined in the metadata.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hm7Pdwy86h"}],"key":"FiMhg44ICd"}],"key":"bPEjG9V5zf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sig0_dc = odc_stac.load(\n    items_eodc,\n    bands=bands,\n    bbox=[lonmin_smaller, latmin_smaller, lonmax_smaller, latmax_smaller],\n    chunks=chunks,\n)","key":"GdACgawdBL"},{"type":"outputs","id":"6o51DK12YSgLgV-SK0fm9","children":[],"key":"dvXIsPRFbj"}],"key":"s71wpxjOo2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Due to the way the data is acquired and stored, some items include “no data” areas. In our case, no data has the value -9999, but this can vary from data provider to data provider. This information can usually be found in the metadata. Furthermore, to save memory, data is often stored as integer (e.g. 25) and not in float (e.g. 2.5) format. For this reason, the backscatter values are often multiplied by a scale factor, in this case factor 10.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KT1trRVJ4Y"}],"key":"upTAX5rdYq"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"As Sentinel-1 satellites overpasses Austria every few days, only some time steps of the dataset will have physical data. As a final step, we will now decode the data and create a plot of two consecutive Sentinel-1 acquisitions of Vienna.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ApiUNoCcXA"}],"key":"uuWooTydiD"}],"key":"CpMaejHtRQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Retrieve the scale factor and NoData value from the metadata. raster:bands is\n# a STAC raster extension\nscale = item.assets[\"VV\"].extra_fields.get(\"raster:bands\")[0][\"scale\"]\nnodata = item.assets[\"VV\"].extra_fields.get(\"raster:bands\")[0][\"nodata\"]\n\n# Decode data with the NoData value and the scale factor\nsig0_dc = sig0_dc.where(sig0_dc != nodata) / scale\n\n# We should remove unnecessary dates when there was no data\n# (no satellite overpass)\nsig0_dc = sig0_dc.dropna(dim=\"time\")","key":"fpCG4M3Uh2"},{"type":"outputs","id":"ABtsIhOM3-7LmQ8vB-CD7","children":[],"key":"jyJP54yVPx"}],"key":"TZe5YKP8rv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sig0_dc.VV.plot(col=\"time\", robust=True, cmap=\"Greys_r\", aspect=1, size=10)","key":"AUT8gbqDOV"},{"type":"outputs","id":"5IpNzHsH1ThPOxrc9P48T","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"<xarray.plot.facetgrid.FacetGrid at 0x7f34d40a9160>","content_type":"text/plain"}}},"key":"hxxVjb4Lof"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 2100x1000 with 3 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"636097f0befb7d332ad97cf0145e073c","path":"/eo-datascience-cookbook/build/636097f0befb7d332ad97cf0145e073c.png"}}},"key":"mcbCXyqXj6"}],"key":"wk1j7JhkCS"}],"key":"xd5NdV06ss"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Figure 3: Sentinel-1 microwave backscatter image for two timeslices.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ACdmSMRmEC"}],"key":"wjUGqKFb2h"}],"key":"sevs2rZWmU"}],"key":"ZeZfBVofqe"}],"key":"JrPJy7MxEG"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Microwave Remote Sensing","url":"/notebooks/courses/microwave-remote-sensing","group":"Courses"},"next":{"title":"Unit Conversion","url":"/notebooks/courses/microwave-remote-sensing/unit-01/in-class-exercise-1","group":"Courses"}}},"domain":"http://localhost:3000"}